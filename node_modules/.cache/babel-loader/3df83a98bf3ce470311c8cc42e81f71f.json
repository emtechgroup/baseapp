{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nexport var getTotalPrice = function getTotalPrice(amount, priceMarket, proposals) {\n  if (proposals.length === 0) {\n    return Number(amount) * priceMarket;\n  }\n\n  var _iterator = _createForOfIteratorHelper(proposals),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var p = _step.value;\n\n      if (p.length < 2) {\n        return Number(amount) * priceMarket;\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  var sum = Number(amount);\n  var list = proposals;\n  var total = 0;\n\n  var _iterator2 = _createForOfIteratorHelper(list),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var proposal = _step2.value;\n\n      if (!sum) {\n        break;\n      }\n\n      if (sum <= Number(proposal[1])) {\n        total += sum * Number(proposal[0]);\n        sum = 0;\n      } else {\n        total += Number(proposal[1]) * Number(proposal[0]);\n        sum -= Number(proposal[1]);\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  if (sum > 0 && list.length >= 1) {\n    // sum is bigger then order book liqudity\n    var lastPrice = Number(list[list.length - 1][0]);\n    total += lastPrice * sum;\n  }\n\n  return total;\n};\nexport var getAmount = function getAmount(avaiblePrice, proposals, value) {\n  var sum = avaiblePrice * value;\n  var list = proposals;\n  var totalAmount = 0;\n\n  var _iterator3 = _createForOfIteratorHelper(list),\n      _step3;\n\n  try {\n    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n      var proposal = _step3.value;\n\n      if (!sum) {\n        break;\n      }\n\n      if (sum <= Number(proposal[0]) * Number(proposal[1])) {\n        totalAmount += sum / Number(proposal[0]);\n        sum = 0;\n      } else {\n        totalAmount += Number(proposal[1]);\n        sum -= Number(proposal[0]) * Number(proposal[1]);\n      }\n    }\n  } catch (err) {\n    _iterator3.e(err);\n  } finally {\n    _iterator3.f();\n  }\n\n  return totalAmount;\n};","map":{"version":3,"sources":["/Users/anthonypafundi/Desktop/baseapp/src/helpers/getTotalPrice.ts"],"names":["getTotalPrice","amount","priceMarket","proposals","length","Number","p","sum","list","total","proposal","lastPrice","getAmount","avaiblePrice","value","totalAmount"],"mappings":";AAAA,OAAO,IAAMA,aAAa,GAAG,SAAhBA,aAAgB,CAACC,MAAD,EAAiBC,WAAjB,EAAsCC,SAAtC,EAAgE;AACzF,MAAIA,SAAS,CAACC,MAAV,KAAqB,CAAzB,EAA4B;AACxB,WAAOC,MAAM,CAACJ,MAAD,CAAN,GAAiBC,WAAxB;AACH;;AAHwF,6CAKzEC,SALyE;AAAA;;AAAA;AAKzF,wDAA2B;AAAA,UAAhBG,CAAgB;;AACvB,UAAIA,CAAC,CAACF,MAAF,GAAW,CAAf,EAAkB;AACd,eAAOC,MAAM,CAACJ,MAAD,CAAN,GAAiBC,WAAxB;AACH;AACJ;AATwF;AAAA;AAAA;AAAA;AAAA;;AAWzF,MAAIK,GAAG,GAAGF,MAAM,CAACJ,MAAD,CAAhB;AAEA,MAAMO,IAAI,GAAGL,SAAb;AACA,MAAIM,KAAK,GAAG,CAAZ;;AAdyF,8CAgBlED,IAhBkE;AAAA;;AAAA;AAgBzF,2DAA6B;AAAA,UAAlBE,QAAkB;;AACzB,UAAI,CAACH,GAAL,EAAU;AACN;AACH;;AAED,UAAIA,GAAG,IAAIF,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAAjB,EAAgC;AAC5BD,QAAAA,KAAK,IAAIF,GAAG,GAAGF,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAArB;AACAH,QAAAA,GAAG,GAAG,CAAN;AACH,OAHD,MAGO;AACHE,QAAAA,KAAK,IAAIJ,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAAN,GAAsBL,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAArC;AACAH,QAAAA,GAAG,IAAIF,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAAb;AACH;AACJ;AA5BwF;AAAA;AAAA;AAAA;AAAA;;AA8BzF,MAAIH,GAAG,GAAG,CAAN,IAAWC,IAAI,CAACJ,MAAL,IAAe,CAA9B,EAAiC;AAAE;AAC/B,QAAMO,SAAS,GAAGN,MAAM,CAACG,IAAI,CAACA,IAAI,CAACJ,MAAL,GAAc,CAAf,CAAJ,CAAsB,CAAtB,CAAD,CAAxB;AACAK,IAAAA,KAAK,IAAIE,SAAS,GAAGJ,GAArB;AACH;;AAED,SAAOE,KAAP;AACH,CApCM;AAsCP,OAAO,IAAMG,SAAS,GAAG,SAAZA,SAAY,CAACC,YAAD,EAAuBV,SAAvB,EAA8CW,KAA9C,EAAgE;AACrF,MAAIP,GAAG,GAAGM,YAAY,GAAGC,KAAzB;AAEA,MAAMN,IAAI,GAAGL,SAAb;AACA,MAAIY,WAAW,GAAG,CAAlB;;AAJqF,8CAM9DP,IAN8D;AAAA;;AAAA;AAMrF,2DAA6B;AAAA,UAAlBE,QAAkB;;AACzB,UAAI,CAACH,GAAL,EAAU;AACN;AACH;;AAED,UAAIA,GAAG,IAAKF,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAAN,GAAsBL,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAAxC,EAAwD;AACpDK,QAAAA,WAAW,IAAIR,GAAG,GAAGF,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAA3B;AACAH,QAAAA,GAAG,GAAG,CAAN;AACH,OAHD,MAGO;AACHQ,QAAAA,WAAW,IAAIV,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAArB;AACAH,QAAAA,GAAG,IAAKF,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAAN,GAAsBL,MAAM,CAACK,QAAQ,CAAC,CAAD,CAAT,CAApC;AACH;AACJ;AAlBoF;AAAA;AAAA;AAAA;AAAA;;AAoBrF,SAAOK,WAAP;AACH,CArBM","sourcesContent":["export const getTotalPrice = (amount: string, priceMarket: number, proposals: string[][]) => {\n    if (proposals.length === 0) {\n        return Number(amount) * priceMarket;\n    }\n\n    for (const p of proposals) {\n        if (p.length < 2) {\n            return Number(amount) * priceMarket;\n        }\n    }\n\n    let sum = Number(amount);\n\n    const list = proposals;\n    let total = 0;\n\n    for (const proposal of list) {\n        if (!sum) {\n            break;\n        }\n\n        if (sum <= Number(proposal[1])) {\n            total += sum * Number(proposal[0]);\n            sum = 0;\n        } else {\n            total += Number(proposal[1]) * Number(proposal[0]);\n            sum -= Number(proposal[1]);\n        }\n    }\n\n    if (sum > 0 && list.length >= 1) { // sum is bigger then order book liqudity\n        const lastPrice = Number(list[list.length - 1][0]);\n        total += lastPrice * sum;\n    }\n\n    return total;\n};\n\nexport const getAmount = (avaiblePrice: number, proposals: string[][], value: number) => {\n    let sum = avaiblePrice * value;\n\n    const list = proposals;\n    let totalAmount = 0;\n\n    for (const proposal of list) {\n        if (!sum) {\n            break;\n        }\n\n        if (sum <= (Number(proposal[0]) * Number(proposal[1]))) {\n            totalAmount += sum / Number(proposal[0]);\n            sum = 0;\n        } else {\n            totalAmount += Number(proposal[1]);\n            sum -= (Number(proposal[0]) * Number(proposal[1]));\n        }\n    }\n\n    return totalAmount;\n};\n"]},"metadata":{},"sourceType":"module"}