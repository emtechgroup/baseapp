{"ast":null,"code":"import _classCallCheck from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nexport var countDecimals = function countDecimals(value) {\n  if (!value || Math.floor(value) === value) {\n    return 0;\n  }\n\n  var decimalPart = value.toString().split('.')[1];\n  return decimalPart ? decimalPart.length : 0;\n};\nexport var FilterPriceCustomStep = /*#__PURE__*/function () {\n  function FilterPriceCustomStep(filter) {\n    _classCallCheck(this, FilterPriceCustomStep);\n\n    this.filter = void 0;\n    this.filter = filter;\n  }\n\n  _createClass(FilterPriceCustomStep, [{\n    key: \"validatePriceStep\",\n    value: function validatePriceStep(price) {\n      var currentValidation = {\n        valid: true,\n        priceStep: 0\n      };\n      var nextIndex = this.filter.rules.findIndex(function (step) {\n        return step && +step.limit > price;\n      });\n      var zeroIndex = this.filter.rules.findIndex(function (step) {\n        return step && +step.limit === 0;\n      });\n      var currentLimit = nextIndex >= 0 ? this.filter.rules[nextIndex] : zeroIndex ? this.filter.rules[zeroIndex] : null;\n\n      if (currentLimit) {\n        var priceDecimals = countDecimals(price);\n        var stepDecimals = countDecimals(currentLimit.step);\n        var targetCoefficient = priceDecimals > stepDecimals ? priceDecimals : stepDecimals;\n        var validStepCoefficient = targetCoefficient ? Math.pow(10, targetCoefficient) : 1;\n        currentValidation.valid = !(+(validStepCoefficient * price).toFixed(0) % (validStepCoefficient * +currentLimit.step));\n        currentValidation.priceStep = !currentValidation.valid ? +currentLimit.step : 0;\n      }\n\n      return currentValidation;\n    }\n  }]);\n\n  return FilterPriceCustomStep;\n}();","map":{"version":3,"sources":["/Users/anthonypafundi/Desktop/baseapp/src/filters/FilterPrice/FilterPriceCustomStep.ts"],"names":["countDecimals","value","Math","floor","decimalPart","toString","split","length","FilterPriceCustomStep","filter","price","currentValidation","valid","priceStep","nextIndex","rules","findIndex","step","limit","zeroIndex","currentLimit","priceDecimals","stepDecimals","targetCoefficient","validStepCoefficient","toFixed"],"mappings":";;AAGA,OAAO,IAAMA,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD,EAAmB;AAC5C,MAAI,CAACA,KAAD,IAAUC,IAAI,CAACC,KAAL,CAAWF,KAAX,MAAsBA,KAApC,EAA2C;AAAE,WAAO,CAAP;AAAW;;AACxD,MAAMG,WAAW,GAAGH,KAAK,CAACI,QAAN,GAAiBC,KAAjB,CAAuB,GAAvB,EAA4B,CAA5B,CAApB;AAEA,SAAOF,WAAW,GAAGA,WAAW,CAACG,MAAf,GAAwB,CAA1C;AACH,CALM;AAOP,WAAaC,qBAAb;AAGI,iCAAYC,MAAZ,EAA4C;AAAA;;AAAA,SAFrCA,MAEqC;AACxC,SAAKA,MAAL,GAAcA,MAAd;AACH;;AALL;AAAA;AAAA,sCAO6BC,KAP7B,EAO6D;AACrD,UAAMC,iBAAkC,GAAG;AAAEC,QAAAA,KAAK,EAAE,IAAT;AAAeC,QAAAA,SAAS,EAAE;AAA1B,OAA3C;AACA,UAAMC,SAAS,GAAG,KAAKL,MAAL,CAAYM,KAAZ,CAAkBC,SAAlB,CAA4B,UAAAC,IAAI;AAAA,eAAIA,IAAI,IAAI,CAACA,IAAI,CAACC,KAAN,GAAcR,KAA1B;AAAA,OAAhC,CAAlB;AACA,UAAMS,SAAS,GAAG,KAAKV,MAAL,CAAYM,KAAZ,CAAkBC,SAAlB,CAA4B,UAAAC,IAAI;AAAA,eAAIA,IAAI,IAAI,CAACA,IAAI,CAACC,KAAN,KAAgB,CAA5B;AAAA,OAAhC,CAAlB;AAEA,UAAME,YAAY,GAAGN,SAAS,IAAI,CAAb,GACjB,KAAKL,MAAL,CAAYM,KAAZ,CAAkBD,SAAlB,CADiB,GAGjBK,SAAS,GAAG,KAAKV,MAAL,CAAYM,KAAZ,CAAkBI,SAAlB,CAAH,GAAkC,IAH/C;;AAMA,UAAIC,YAAJ,EAAkB;AACd,YAAMC,aAAa,GAAGrB,aAAa,CAACU,KAAD,CAAnC;AACA,YAAMY,YAAY,GAAGtB,aAAa,CAACoB,YAAY,CAACH,IAAd,CAAlC;AACA,YAAMM,iBAAiB,GAAGF,aAAa,GAAGC,YAAhB,GAA+BD,aAA/B,GAA+CC,YAAzE;AACA,YAAME,oBAAoB,GAAGD,iBAAiB,YAAG,EAAH,EAASA,iBAAT,IAA6B,CAA3E;AAEAZ,QAAAA,iBAAiB,CAACC,KAAlB,GAA0B,EAAE,CAAC,CAACY,oBAAoB,GAAGd,KAAxB,EAA+Be,OAA/B,CAAuC,CAAvC,CAAD,IAA8CD,oBAAoB,GAAG,CAACJ,YAAY,CAACH,IAAnF,CAAF,CAA1B;AACAN,QAAAA,iBAAiB,CAACE,SAAlB,GAA8B,CAACF,iBAAiB,CAACC,KAAnB,GAA2B,CAACQ,YAAY,CAACH,IAAzC,GAAgD,CAA9E;AACH;;AAED,aAAON,iBAAP;AACH;AA7BL;;AAAA;AAAA","sourcesContent":["import { MarketFilterCustomStep } from '../../modules';\nimport { FilterPrice, PriceValidation } from './';\n\nexport const countDecimals = (value): number => {\n    if (!value || Math.floor(value) === value) { return 0; }\n    const decimalPart = value.toString().split('.')[1];\n\n    return decimalPart ? decimalPart.length : 0;\n};\n\nexport class FilterPriceCustomStep implements FilterPrice {\n    public filter: MarketFilterCustomStep;\n\n    constructor(filter: MarketFilterCustomStep) {\n        this.filter = filter;\n    }\n\n    public validatePriceStep(price: number): PriceValidation {\n        const currentValidation: PriceValidation = { valid: true, priceStep: 0 };\n        const nextIndex = this.filter.rules.findIndex(step => step && +step.limit > price);\n        const zeroIndex = this.filter.rules.findIndex(step => step && +step.limit === 0);\n\n        const currentLimit = nextIndex >= 0 ? (\n            this.filter.rules[nextIndex]\n        ) : (\n            zeroIndex ? this.filter.rules[zeroIndex] : null\n        );\n\n        if (currentLimit) {\n            const priceDecimals = countDecimals(price);\n            const stepDecimals = countDecimals(currentLimit.step);\n            const targetCoefficient = priceDecimals > stepDecimals ? priceDecimals : stepDecimals;\n            const validStepCoefficient = targetCoefficient ? 10 ** targetCoefficient : 1;\n\n            currentValidation.valid = !(+(validStepCoefficient * price).toFixed(0) % (validStepCoefficient * +currentLimit.step));\n            currentValidation.priceStep = !currentValidation.valid ? +currentLimit.step : 0;\n        }\n\n        return currentValidation;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}