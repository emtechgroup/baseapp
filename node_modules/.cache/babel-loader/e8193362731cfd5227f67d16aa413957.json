{"ast":null,"code":"(function (module, exports) {\n  'use strict'; // Utils\n\n  function assert(val, msg) {\n    if (!val) throw new Error(msg || 'Assertion failed');\n  } // Could use `inherits` module, but don't want to move from single file\n  // architecture yet.\n\n\n  function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor;\n\n    var TempCtor = function TempCtor() {};\n\n    TempCtor.prototype = superCtor.prototype;\n    ctor.prototype = new TempCtor();\n    ctor.prototype.constructor = ctor;\n  } // BN\n\n\n  function BN(number, base, endian) {\n    // May be `new BN(bn)` ?\n    if (number !== null && typeof number === 'object' && Array.isArray(number.words)) {\n      return number;\n    }\n\n    this.sign = false;\n    this.words = null;\n    this.length = 0; // Reduction context\n\n    this.red = null;\n\n    if (base === 'le' || base === 'be') {\n      endian = base;\n      base = 10;\n    }\n\n    if (number !== null) this._init(number || 0, base || 10, endian || 'be');\n  }\n\n  if (typeof module === 'object') module.exports = BN;else exports.BN = BN;\n  BN.BN = BN;\n  BN.wordSize = 26;\n\n  BN.prototype._init = function init(number, base, endian) {\n    if (typeof number === 'number') {\n      return this._initNumber(number, base, endian);\n    } else if (typeof number === 'object') {\n      return this._initArray(number, base, endian);\n    }\n\n    if (base === 'hex') base = 16;\n    assert(base === (base | 0) && base >= 2 && base <= 36);\n    number = number.toString().replace(/\\s+/g, '');\n    var start = 0;\n    if (number[0] === '-') start++;\n    if (base === 16) this._parseHex(number, start);else this._parseBase(number, base, start);\n    if (number[0] === '-') this.sign = true;\n    this.strip();\n    if (endian !== 'le') return;\n\n    this._initArray(this.toArray(), base, endian);\n  };\n\n  BN.prototype._initNumber = function _initNumber(number, base, endian) {\n    if (number < 0) {\n      this.sign = true;\n      number = -number;\n    }\n\n    if (number < 0x4000000) {\n      this.words = [number & 0x3ffffff];\n      this.length = 1;\n    } else if (number < 0x10000000000000) {\n      this.words = [number & 0x3ffffff, number / 0x4000000 & 0x3ffffff];\n      this.length = 2;\n    } else {\n      assert(number < 0x20000000000000); // 2 ^ 53 (unsafe)\n\n      this.words = [number & 0x3ffffff, number / 0x4000000 & 0x3ffffff, 1];\n      this.length = 3;\n    }\n\n    if (endian !== 'le') return; // Reverse the bytes\n\n    this._initArray(this.toArray(), base, endian);\n  };\n\n  BN.prototype._initArray = function _initArray(number, base, endian) {\n    // Perhaps a Uint8Array\n    assert(typeof number.length === 'number');\n\n    if (number.length <= 0) {\n      this.words = [0];\n      this.length = 1;\n      return this;\n    }\n\n    this.length = Math.ceil(number.length / 3);\n    this.words = new Array(this.length);\n\n    for (var i = 0; i < this.length; i++) {\n      this.words[i] = 0;\n    }\n\n    var off = 0;\n\n    if (endian === 'be') {\n      for (var i = number.length - 1, j = 0; i >= 0; i -= 3) {\n        var w = number[i] | number[i - 1] << 8 | number[i - 2] << 16;\n        this.words[j] |= w << off & 0x3ffffff;\n        this.words[j + 1] = w >>> 26 - off & 0x3ffffff;\n        off += 24;\n\n        if (off >= 26) {\n          off -= 26;\n          j++;\n        }\n      }\n    } else if (endian === 'le') {\n      for (var i = 0, j = 0; i < number.length; i += 3) {\n        var w = number[i] | number[i + 1] << 8 | number[i + 2] << 16;\n        this.words[j] |= w << off & 0x3ffffff;\n        this.words[j + 1] = w >>> 26 - off & 0x3ffffff;\n        off += 24;\n\n        if (off >= 26) {\n          off -= 26;\n          j++;\n        }\n      }\n    }\n\n    return this.strip();\n  };\n\n  function parseHex(str, start, end) {\n    var r = 0;\n    var len = Math.min(str.length, end);\n\n    for (var i = start; i < len; i++) {\n      var c = str.charCodeAt(i) - 48;\n      r <<= 4; // 'a' - 'f'\n\n      if (c >= 49 && c <= 54) r |= c - 49 + 0xa; // 'A' - 'F'\n      else if (c >= 17 && c <= 22) r |= c - 17 + 0xa; // '0' - '9'\n        else r |= c & 0xf;\n    }\n\n    return r;\n  }\n\n  BN.prototype._parseHex = function _parseHex(number, start) {\n    // Create possibly bigger array to ensure that it fits the number\n    this.length = Math.ceil((number.length - start) / 6);\n    this.words = new Array(this.length);\n\n    for (var i = 0; i < this.length; i++) {\n      this.words[i] = 0;\n    } // Scan 24-bit chunks and add them to the number\n\n\n    var off = 0;\n\n    for (var i = number.length - 6, j = 0; i >= start; i -= 6) {\n      var w = parseHex(number, i, i + 6);\n      this.words[j] |= w << off & 0x3ffffff;\n      this.words[j + 1] |= w >>> 26 - off & 0x3fffff;\n      off += 24;\n\n      if (off >= 26) {\n        off -= 26;\n        j++;\n      }\n    }\n\n    if (i + 6 !== start) {\n      var w = parseHex(number, start, i + 6);\n      this.words[j] |= w << off & 0x3ffffff;\n      this.words[j + 1] |= w >>> 26 - off & 0x3fffff;\n    }\n\n    this.strip();\n  };\n\n  function parseBase(str, start, end, mul) {\n    var r = 0;\n    var len = Math.min(str.length, end);\n\n    for (var i = start; i < len; i++) {\n      var c = str.charCodeAt(i) - 48;\n      r *= mul; // 'a'\n\n      if (c >= 49) r += c - 49 + 0xa; // 'A'\n      else if (c >= 17) r += c - 17 + 0xa; // '0' - '9'\n        else r += c;\n    }\n\n    return r;\n  }\n\n  BN.prototype._parseBase = function _parseBase(number, base, start) {\n    // Initialize as zero\n    this.words = [0];\n    this.length = 1; // Find length of limb in base\n\n    for (var limbLen = 0, limbPow = 1; limbPow <= 0x3ffffff; limbPow *= base) {\n      limbLen++;\n    }\n\n    limbLen--;\n    limbPow = limbPow / base | 0;\n    var total = number.length - start;\n    var mod = total % limbLen;\n    var end = Math.min(total, total - mod) + start;\n    var word = 0;\n\n    for (var i = start; i < end; i += limbLen) {\n      word = parseBase(number, i, i + limbLen, base);\n      this.imuln(limbPow);\n      if (this.words[0] + word < 0x4000000) this.words[0] += word;else this._iaddn(word);\n    }\n\n    if (mod !== 0) {\n      var pow = 1;\n      var word = parseBase(number, i, number.length, base);\n\n      for (var i = 0; i < mod; i++) {\n        pow *= base;\n      }\n\n      this.imuln(pow);\n      if (this.words[0] + word < 0x4000000) this.words[0] += word;else this._iaddn(word);\n    }\n  };\n\n  BN.prototype.copy = function copy(dest) {\n    dest.words = new Array(this.length);\n\n    for (var i = 0; i < this.length; i++) {\n      dest.words[i] = this.words[i];\n    }\n\n    dest.length = this.length;\n    dest.sign = this.sign;\n    dest.red = this.red;\n  };\n\n  BN.prototype.clone = function clone() {\n    var r = new BN(null);\n    this.copy(r);\n    return r;\n  }; // Remove leading `0` from `this`\n\n\n  BN.prototype.strip = function strip() {\n    while (this.length > 1 && this.words[this.length - 1] === 0) {\n      this.length--;\n    }\n\n    return this._normSign();\n  };\n\n  BN.prototype._normSign = function _normSign() {\n    // -0 = 0\n    if (this.length === 1 && this.words[0] === 0) this.sign = false;\n    return this;\n  };\n\n  BN.prototype.inspect = function inspect() {\n    return (this.red ? '<BN-R: ' : '<BN: ') + this.toString(16) + '>';\n  };\n  /*\n  \n  var zeros = [];\n  var groupSizes = [];\n  var groupBases = [];\n  \n  var s = '';\n  var i = -1;\n  while (++i < BN.wordSize) {\n    zeros[i] = s;\n    s += '0';\n  }\n  groupSizes[0] = 0;\n  groupSizes[1] = 0;\n  groupBases[0] = 0;\n  groupBases[1] = 0;\n  var base = 2 - 1;\n  while (++base < 36 + 1) {\n    var groupSize = 0;\n    var groupBase = 1;\n    while (groupBase < (1 << BN.wordSize) / base) {\n      groupBase *= base;\n      groupSize += 1;\n    }\n    groupSizes[base] = groupSize;\n    groupBases[base] = groupBase;\n  }\n  \n  */\n\n\n  var zeros = ['', '0', '00', '000', '0000', '00000', '000000', '0000000', '00000000', '000000000', '0000000000', '00000000000', '000000000000', '0000000000000', '00000000000000', '000000000000000', '0000000000000000', '00000000000000000', '000000000000000000', '0000000000000000000', '00000000000000000000', '000000000000000000000', '0000000000000000000000', '00000000000000000000000', '000000000000000000000000', '0000000000000000000000000'];\n  var groupSizes = [0, 0, 25, 16, 12, 11, 10, 9, 8, 8, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5];\n  var groupBases = [0, 0, 33554432, 43046721, 16777216, 48828125, 60466176, 40353607, 16777216, 43046721, 10000000, 19487171, 35831808, 62748517, 7529536, 11390625, 16777216, 24137569, 34012224, 47045881, 64000000, 4084101, 5153632, 6436343, 7962624, 9765625, 11881376, 14348907, 17210368, 20511149, 24300000, 28629151, 33554432, 39135393, 45435424, 52521875, 60466176];\n\n  BN.prototype.toString = function toString(base, padding) {\n    base = base || 10;\n\n    if (base === 16 || base === 'hex') {\n      var out = '';\n      var off = 0;\n      var padding = padding | 0 || 1;\n      var carry = 0;\n\n      for (var i = 0; i < this.length; i++) {\n        var w = this.words[i];\n        var word = ((w << off | carry) & 0xffffff).toString(16);\n        carry = w >>> 24 - off & 0xffffff;\n        if (carry !== 0 || i !== this.length - 1) out = zeros[6 - word.length] + word + out;else out = word + out;\n        off += 2;\n\n        if (off >= 26) {\n          off -= 26;\n          i--;\n        }\n      }\n\n      if (carry !== 0) out = carry.toString(16) + out;\n\n      while (out.length % padding !== 0) {\n        out = '0' + out;\n      }\n\n      if (this.sign) out = '-' + out;\n      return out;\n    } else if (base === (base | 0) && base >= 2 && base <= 36) {\n      // var groupSize = Math.floor(BN.wordSize * Math.LN2 / Math.log(base));\n      var groupSize = groupSizes[base]; // var groupBase = Math.pow(base, groupSize);\n\n      var groupBase = groupBases[base];\n      var out = '';\n      var c = this.clone();\n      c.sign = false;\n\n      while (c.cmpn(0) !== 0) {\n        var r = c.modn(groupBase).toString(base);\n        c = c.idivn(groupBase);\n        if (c.cmpn(0) !== 0) out = zeros[groupSize - r.length] + r + out;else out = r + out;\n      }\n\n      if (this.cmpn(0) === 0) out = '0' + out;\n      if (this.sign) out = '-' + out;\n      return out;\n    } else {\n      assert(false, 'Base should be between 2 and 36');\n    }\n  };\n\n  BN.prototype.toJSON = function toJSON() {\n    return this.toString(16);\n  };\n\n  BN.prototype.toArray = function toArray(endian) {\n    this.strip();\n    var res = new Array(this.byteLength());\n    res[0] = 0;\n    var q = this.clone();\n\n    if (endian !== 'le') {\n      // Assume big-endian\n      for (var i = 0; q.cmpn(0) !== 0; i++) {\n        var b = q.andln(0xff);\n        q.ishrn(8);\n        res[res.length - i - 1] = b;\n      }\n    } else {\n      // Assume little-endian\n      for (var i = 0; q.cmpn(0) !== 0; i++) {\n        var b = q.andln(0xff);\n        q.ishrn(8);\n        res[i] = b;\n      }\n    }\n\n    return res;\n  };\n\n  if (Math.clz32) {\n    BN.prototype._countBits = function _countBits(w) {\n      return 32 - Math.clz32(w);\n    };\n  } else {\n    BN.prototype._countBits = function _countBits(w) {\n      var t = w;\n      var r = 0;\n\n      if (t >= 0x1000) {\n        r += 13;\n        t >>>= 13;\n      }\n\n      if (t >= 0x40) {\n        r += 7;\n        t >>>= 7;\n      }\n\n      if (t >= 0x8) {\n        r += 4;\n        t >>>= 4;\n      }\n\n      if (t >= 0x02) {\n        r += 2;\n        t >>>= 2;\n      }\n\n      return r + t;\n    };\n  }\n\n  BN.prototype._zeroBits = function _zeroBits(w) {\n    // Short-cut\n    if (w === 0) return 26;\n    var t = w;\n    var r = 0;\n\n    if ((t & 0x1fff) === 0) {\n      r += 13;\n      t >>>= 13;\n    }\n\n    if ((t & 0x7f) === 0) {\n      r += 7;\n      t >>>= 7;\n    }\n\n    if ((t & 0xf) === 0) {\n      r += 4;\n      t >>>= 4;\n    }\n\n    if ((t & 0x3) === 0) {\n      r += 2;\n      t >>>= 2;\n    }\n\n    if ((t & 0x1) === 0) r++;\n    return r;\n  }; // Return number of used bits in a BN\n\n\n  BN.prototype.bitLength = function bitLength() {\n    var hi = 0;\n    var w = this.words[this.length - 1];\n\n    var hi = this._countBits(w);\n\n    return (this.length - 1) * 26 + hi;\n  }; // Number of trailing zero bits\n\n\n  BN.prototype.zeroBits = function zeroBits() {\n    if (this.cmpn(0) === 0) return 0;\n    var r = 0;\n\n    for (var i = 0; i < this.length; i++) {\n      var b = this._zeroBits(this.words[i]);\n\n      r += b;\n      if (b !== 26) break;\n    }\n\n    return r;\n  };\n\n  BN.prototype.byteLength = function byteLength() {\n    return Math.ceil(this.bitLength() / 8);\n  }; // Return negative clone of `this`\n\n\n  BN.prototype.neg = function neg() {\n    if (this.cmpn(0) === 0) return this.clone();\n    var r = this.clone();\n    r.sign = !this.sign;\n    return r;\n  }; // Or `num` with `this` in-place\n\n\n  BN.prototype.ior = function ior(num) {\n    this.sign = this.sign || num.sign;\n\n    while (this.length < num.length) {\n      this.words[this.length++] = 0;\n    }\n\n    for (var i = 0; i < num.length; i++) {\n      this.words[i] = this.words[i] | num.words[i];\n    }\n\n    return this.strip();\n  }; // Or `num` with `this`\n\n\n  BN.prototype.or = function or(num) {\n    if (this.length > num.length) return this.clone().ior(num);else return num.clone().ior(this);\n  }; // And `num` with `this` in-place\n\n\n  BN.prototype.iand = function iand(num) {\n    this.sign = this.sign && num.sign; // b = min-length(num, this)\n\n    var b;\n    if (this.length > num.length) b = num;else b = this;\n\n    for (var i = 0; i < b.length; i++) {\n      this.words[i] = this.words[i] & num.words[i];\n    }\n\n    this.length = b.length;\n    return this.strip();\n  }; // And `num` with `this`\n\n\n  BN.prototype.and = function and(num) {\n    if (this.length > num.length) return this.clone().iand(num);else return num.clone().iand(this);\n  }; // Xor `num` with `this` in-place\n\n\n  BN.prototype.ixor = function ixor(num) {\n    this.sign = this.sign || num.sign; // a.length > b.length\n\n    var a;\n    var b;\n\n    if (this.length > num.length) {\n      a = this;\n      b = num;\n    } else {\n      a = num;\n      b = this;\n    }\n\n    for (var i = 0; i < b.length; i++) {\n      this.words[i] = a.words[i] ^ b.words[i];\n    }\n\n    if (this !== a) for (; i < a.length; i++) {\n      this.words[i] = a.words[i];\n    }\n    this.length = a.length;\n    return this.strip();\n  }; // Xor `num` with `this`\n\n\n  BN.prototype.xor = function xor(num) {\n    if (this.length > num.length) return this.clone().ixor(num);else return num.clone().ixor(this);\n  }; // Set `bit` of `this`\n\n\n  BN.prototype.setn = function setn(bit, val) {\n    assert(typeof bit === 'number' && bit >= 0);\n    var off = bit / 26 | 0;\n    var wbit = bit % 26;\n\n    while (this.length <= off) {\n      this.words[this.length++] = 0;\n    }\n\n    if (val) this.words[off] = this.words[off] | 1 << wbit;else this.words[off] = this.words[off] & ~(1 << wbit);\n    return this.strip();\n  }; // Add `num` to `this` in-place\n\n\n  BN.prototype.iadd = function iadd(num) {\n    // negative + positive\n    if (this.sign && !num.sign) {\n      this.sign = false;\n      var r = this.isub(num);\n      this.sign = !this.sign;\n      return this._normSign(); // positive + negative\n    } else if (!this.sign && num.sign) {\n      num.sign = false;\n      var r = this.isub(num);\n      num.sign = true;\n      return r._normSign();\n    } // a.length > b.length\n\n\n    var a;\n    var b;\n\n    if (this.length > num.length) {\n      a = this;\n      b = num;\n    } else {\n      a = num;\n      b = this;\n    }\n\n    var carry = 0;\n\n    for (var i = 0; i < b.length; i++) {\n      var r = a.words[i] + b.words[i] + carry;\n      this.words[i] = r & 0x3ffffff;\n      carry = r >>> 26;\n    }\n\n    for (; carry !== 0 && i < a.length; i++) {\n      var r = a.words[i] + carry;\n      this.words[i] = r & 0x3ffffff;\n      carry = r >>> 26;\n    }\n\n    this.length = a.length;\n\n    if (carry !== 0) {\n      this.words[this.length] = carry;\n      this.length++; // Copy the rest of the words\n    } else if (a !== this) {\n      for (; i < a.length; i++) {\n        this.words[i] = a.words[i];\n      }\n    }\n\n    return this;\n  }; // Add `num` to `this`\n\n\n  BN.prototype.add = function add(num) {\n    if (num.sign && !this.sign) {\n      num.sign = false;\n      var res = this.sub(num);\n      num.sign = true;\n      return res;\n    } else if (!num.sign && this.sign) {\n      this.sign = false;\n      var res = num.sub(this);\n      this.sign = true;\n      return res;\n    }\n\n    if (this.length > num.length) return this.clone().iadd(num);else return num.clone().iadd(this);\n  }; // Subtract `num` from `this` in-place\n\n\n  BN.prototype.isub = function isub(num) {\n    // this - (-num) = this + num\n    if (num.sign) {\n      num.sign = false;\n      var r = this.iadd(num);\n      num.sign = true;\n      return r._normSign(); // -this - num = -(this + num)\n    } else if (this.sign) {\n      this.sign = false;\n      this.iadd(num);\n      this.sign = true;\n      return this._normSign();\n    } // At this point both numbers are positive\n\n\n    var cmp = this.cmp(num); // Optimization - zeroify\n\n    if (cmp === 0) {\n      this.sign = false;\n      this.length = 1;\n      this.words[0] = 0;\n      return this;\n    } // a > b\n\n\n    var a;\n    var b;\n\n    if (cmp > 0) {\n      a = this;\n      b = num;\n    } else {\n      a = num;\n      b = this;\n    }\n\n    var carry = 0;\n\n    for (var i = 0; i < b.length; i++) {\n      var r = a.words[i] - b.words[i] + carry;\n      carry = r >> 26;\n      this.words[i] = r & 0x3ffffff;\n    }\n\n    for (; carry !== 0 && i < a.length; i++) {\n      var r = a.words[i] + carry;\n      carry = r >> 26;\n      this.words[i] = r & 0x3ffffff;\n    } // Copy rest of the words\n\n\n    if (carry === 0 && i < a.length && a !== this) for (; i < a.length; i++) {\n      this.words[i] = a.words[i];\n    }\n    this.length = Math.max(this.length, i);\n    if (a !== this) this.sign = true;\n    return this.strip();\n  }; // Subtract `num` from `this`\n\n\n  BN.prototype.sub = function sub(num) {\n    return this.clone().isub(num);\n  };\n  /*\n  // NOTE: This could be potentionally used to generate loop-less multiplications\n  function _genCombMulTo(alen, blen) {\n    var len = alen + blen - 1;\n    var src = [\n      'var a = this.words, b = num.words, o = out.words, c = 0, w, ' +\n          'mask = 0x3ffffff, shift = 0x4000000;',\n      'out.length = ' + len + ';'\n    ];\n    for (var k = 0; k < len; k++) {\n      var minJ = Math.max(0, k - alen + 1);\n      var maxJ = Math.min(k, blen - 1);\n  \n      for (var j = minJ; j <= maxJ; j++) {\n        var i = k - j;\n        var mul = 'a[' + i + '] * b[' + j + ']';\n  \n        if (j === minJ) {\n          src.push('w = ' + mul + ' + c;');\n          src.push('c = (w / shift) | 0;');\n        } else {\n          src.push('w += ' + mul + ';');\n          src.push('c += (w / shift) | 0;');\n        }\n        src.push('w &= mask;');\n      }\n      src.push('o[' + k + '] = w;');\n    }\n    src.push('if (c !== 0) {',\n             '  o[' + k + '] = c;',\n             '  out.length++;',\n             '}',\n             'return out;');\n  \n    return src.join('\\n');\n  }\n  */\n\n\n  BN.prototype._smallMulTo = function _smallMulTo(num, out) {\n    out.sign = num.sign !== this.sign;\n    out.length = this.length + num.length;\n    var carry = 0;\n\n    for (var k = 0; k < out.length - 1; k++) {\n      // Sum all words with the same `i + j = k` and accumulate `ncarry`,\n      // note that ncarry could be >= 0x3ffffff\n      var ncarry = carry >>> 26;\n      var rword = carry & 0x3ffffff;\n      var maxJ = Math.min(k, num.length - 1);\n\n      for (var j = Math.max(0, k - this.length + 1); j <= maxJ; j++) {\n        var i = k - j;\n        var a = this.words[i] | 0;\n        var b = num.words[j] | 0;\n        var r = a * b;\n        var lo = r & 0x3ffffff;\n        ncarry = ncarry + (r / 0x4000000 | 0) | 0;\n        lo = lo + rword | 0;\n        rword = lo & 0x3ffffff;\n        ncarry = ncarry + (lo >>> 26) | 0;\n      }\n\n      out.words[k] = rword;\n      carry = ncarry;\n    }\n\n    if (carry !== 0) {\n      out.words[k] = carry;\n    } else {\n      out.length--;\n    }\n\n    return out.strip();\n  };\n\n  BN.prototype._bigMulTo = function _bigMulTo(num, out) {\n    out.sign = num.sign !== this.sign;\n    out.length = this.length + num.length;\n    var carry = 0;\n    var hncarry = 0;\n\n    for (var k = 0; k < out.length - 1; k++) {\n      // Sum all words with the same `i + j = k` and accumulate `ncarry`,\n      // note that ncarry could be >= 0x3ffffff\n      var ncarry = hncarry;\n      hncarry = 0;\n      var rword = carry & 0x3ffffff;\n      var maxJ = Math.min(k, num.length - 1);\n\n      for (var j = Math.max(0, k - this.length + 1); j <= maxJ; j++) {\n        var i = k - j;\n        var a = this.words[i] | 0;\n        var b = num.words[j] | 0;\n        var r = a * b;\n        var lo = r & 0x3ffffff;\n        ncarry = ncarry + (r / 0x4000000 | 0) | 0;\n        lo = lo + rword | 0;\n        rword = lo & 0x3ffffff;\n        ncarry = ncarry + (lo >>> 26) | 0;\n        hncarry += ncarry >>> 26;\n        ncarry &= 0x3ffffff;\n      }\n\n      out.words[k] = rword;\n      carry = ncarry;\n      ncarry = hncarry;\n    }\n\n    if (carry !== 0) {\n      out.words[k] = carry;\n    } else {\n      out.length--;\n    }\n\n    return out.strip();\n  };\n\n  BN.prototype.mulTo = function mulTo(num, out) {\n    var res;\n    if (this.length + num.length < 63) res = this._smallMulTo(num, out);else res = this._bigMulTo(num, out);\n    return res;\n  }; // Multiply `this` by `num`\n\n\n  BN.prototype.mul = function mul(num) {\n    var out = new BN(null);\n    out.words = new Array(this.length + num.length);\n    return this.mulTo(num, out);\n  }; // In-place Multiplication\n\n\n  BN.prototype.imul = function imul(num) {\n    if (this.cmpn(0) === 0 || num.cmpn(0) === 0) {\n      this.words[0] = 0;\n      this.length = 1;\n      return this;\n    }\n\n    var tlen = this.length;\n    var nlen = num.length;\n    this.sign = num.sign !== this.sign;\n    this.length = this.length + num.length;\n    this.words[this.length - 1] = 0;\n\n    for (var k = this.length - 2; k >= 0; k--) {\n      // Sum all words with the same `i + j = k` and accumulate `carry`,\n      // note that carry could be >= 0x3ffffff\n      var carry = 0;\n      var rword = 0;\n      var maxJ = Math.min(k, nlen - 1);\n\n      for (var j = Math.max(0, k - tlen + 1); j <= maxJ; j++) {\n        var i = k - j;\n        var a = this.words[i];\n        var b = num.words[j];\n        var r = a * b;\n        var lo = r & 0x3ffffff;\n        carry += r / 0x4000000 | 0;\n        lo += rword;\n        rword = lo & 0x3ffffff;\n        carry += lo >>> 26;\n      }\n\n      this.words[k] = rword;\n      this.words[k + 1] += carry;\n      carry = 0;\n    } // Propagate overflows\n\n\n    var carry = 0;\n\n    for (var i = 1; i < this.length; i++) {\n      var w = this.words[i] + carry;\n      this.words[i] = w & 0x3ffffff;\n      carry = w >>> 26;\n    }\n\n    return this.strip();\n  };\n\n  BN.prototype.imuln = function imuln(num) {\n    assert(typeof num === 'number'); // Carry\n\n    var carry = 0;\n\n    for (var i = 0; i < this.length; i++) {\n      var w = this.words[i] * num;\n      var lo = (w & 0x3ffffff) + (carry & 0x3ffffff);\n      carry >>= 26;\n      carry += w / 0x4000000 | 0; // NOTE: lo is 27bit maximum\n\n      carry += lo >>> 26;\n      this.words[i] = lo & 0x3ffffff;\n    }\n\n    if (carry !== 0) {\n      this.words[i] = carry;\n      this.length++;\n    }\n\n    return this;\n  };\n\n  BN.prototype.muln = function muln(num) {\n    return this.clone().imuln(num);\n  }; // `this` * `this`\n\n\n  BN.prototype.sqr = function sqr() {\n    return this.mul(this);\n  }; // `this` * `this` in-place\n\n\n  BN.prototype.isqr = function isqr() {\n    return this.mul(this);\n  }; // Shift-left in-place\n\n\n  BN.prototype.ishln = function ishln(bits) {\n    assert(typeof bits === 'number' && bits >= 0);\n    var r = bits % 26;\n    var s = (bits - r) / 26;\n    var carryMask = 0x3ffffff >>> 26 - r << 26 - r;\n\n    if (r !== 0) {\n      var carry = 0;\n\n      for (var i = 0; i < this.length; i++) {\n        var newCarry = this.words[i] & carryMask;\n        var c = this.words[i] - newCarry << r;\n        this.words[i] = c | carry;\n        carry = newCarry >>> 26 - r;\n      }\n\n      if (carry) {\n        this.words[i] = carry;\n        this.length++;\n      }\n    }\n\n    if (s !== 0) {\n      for (var i = this.length - 1; i >= 0; i--) {\n        this.words[i + s] = this.words[i];\n      }\n\n      for (var i = 0; i < s; i++) {\n        this.words[i] = 0;\n      }\n\n      this.length += s;\n    }\n\n    return this.strip();\n  }; // Shift-right in-place\n  // NOTE: `hint` is a lowest bit before trailing zeroes\n  // NOTE: if `extended` is present - it will be filled with destroyed bits\n\n\n  BN.prototype.ishrn = function ishrn(bits, hint, extended) {\n    assert(typeof bits === 'number' && bits >= 0);\n    var h;\n    if (hint) h = (hint - hint % 26) / 26;else h = 0;\n    var r = bits % 26;\n    var s = Math.min((bits - r) / 26, this.length);\n    var mask = 0x3ffffff ^ 0x3ffffff >>> r << r;\n    var maskedWords = extended;\n    h -= s;\n    h = Math.max(0, h); // Extended mode, copy masked part\n\n    if (maskedWords) {\n      for (var i = 0; i < s; i++) {\n        maskedWords.words[i] = this.words[i];\n      }\n\n      maskedWords.length = s;\n    }\n\n    if (s === 0) {// No-op, we should not move anything at all\n    } else if (this.length > s) {\n      this.length -= s;\n\n      for (var i = 0; i < this.length; i++) {\n        this.words[i] = this.words[i + s];\n      }\n    } else {\n      this.words[0] = 0;\n      this.length = 1;\n    }\n\n    var carry = 0;\n\n    for (var i = this.length - 1; i >= 0 && (carry !== 0 || i >= h); i--) {\n      var word = this.words[i];\n      this.words[i] = carry << 26 - r | word >>> r;\n      carry = word & mask;\n    } // Push carried bits as a mask\n\n\n    if (maskedWords && carry !== 0) maskedWords.words[maskedWords.length++] = carry;\n\n    if (this.length === 0) {\n      this.words[0] = 0;\n      this.length = 1;\n    }\n\n    this.strip();\n    return this;\n  }; // Shift-left\n\n\n  BN.prototype.shln = function shln(bits) {\n    return this.clone().ishln(bits);\n  }; // Shift-right\n\n\n  BN.prototype.shrn = function shrn(bits) {\n    return this.clone().ishrn(bits);\n  }; // Test if n bit is set\n\n\n  BN.prototype.testn = function testn(bit) {\n    assert(typeof bit === 'number' && bit >= 0);\n    var r = bit % 26;\n    var s = (bit - r) / 26;\n    var q = 1 << r; // Fast case: bit is much higher than all existing words\n\n    if (this.length <= s) {\n      return false;\n    } // Check bit and return\n\n\n    var w = this.words[s];\n    return !!(w & q);\n  }; // Return only lowers bits of number (in-place)\n\n\n  BN.prototype.imaskn = function imaskn(bits) {\n    assert(typeof bits === 'number' && bits >= 0);\n    var r = bits % 26;\n    var s = (bits - r) / 26;\n    assert(!this.sign, 'imaskn works only with positive numbers');\n    if (r !== 0) s++;\n    this.length = Math.min(s, this.length);\n\n    if (r !== 0) {\n      var mask = 0x3ffffff ^ 0x3ffffff >>> r << r;\n      this.words[this.length - 1] &= mask;\n    }\n\n    return this.strip();\n  }; // Return only lowers bits of number\n\n\n  BN.prototype.maskn = function maskn(bits) {\n    return this.clone().imaskn(bits);\n  }; // Add plain number `num` to `this`\n\n\n  BN.prototype.iaddn = function iaddn(num) {\n    assert(typeof num === 'number');\n    if (num < 0) return this.isubn(-num); // Possible sign change\n\n    if (this.sign) {\n      if (this.length === 1 && this.words[0] < num) {\n        this.words[0] = num - this.words[0];\n        this.sign = false;\n        return this;\n      }\n\n      this.sign = false;\n      this.isubn(num);\n      this.sign = true;\n      return this;\n    } // Add without checks\n\n\n    return this._iaddn(num);\n  };\n\n  BN.prototype._iaddn = function _iaddn(num) {\n    this.words[0] += num; // Carry\n\n    for (var i = 0; i < this.length && this.words[i] >= 0x4000000; i++) {\n      this.words[i] -= 0x4000000;\n      if (i === this.length - 1) this.words[i + 1] = 1;else this.words[i + 1]++;\n    }\n\n    this.length = Math.max(this.length, i + 1);\n    return this;\n  }; // Subtract plain number `num` from `this`\n\n\n  BN.prototype.isubn = function isubn(num) {\n    assert(typeof num === 'number');\n    if (num < 0) return this.iaddn(-num);\n\n    if (this.sign) {\n      this.sign = false;\n      this.iaddn(num);\n      this.sign = true;\n      return this;\n    }\n\n    this.words[0] -= num; // Carry\n\n    for (var i = 0; i < this.length && this.words[i] < 0; i++) {\n      this.words[i] += 0x4000000;\n      this.words[i + 1] -= 1;\n    }\n\n    return this.strip();\n  };\n\n  BN.prototype.addn = function addn(num) {\n    return this.clone().iaddn(num);\n  };\n\n  BN.prototype.subn = function subn(num) {\n    return this.clone().isubn(num);\n  };\n\n  BN.prototype.iabs = function iabs() {\n    this.sign = false;\n    return this;\n  };\n\n  BN.prototype.abs = function abs() {\n    return this.clone().iabs();\n  };\n\n  BN.prototype._ishlnsubmul = function _ishlnsubmul(num, mul, shift) {\n    // Bigger storage is needed\n    var len = num.length + shift;\n    var i;\n\n    if (this.words.length < len) {\n      var t = new Array(len);\n\n      for (var i = 0; i < this.length; i++) {\n        t[i] = this.words[i];\n      }\n\n      this.words = t;\n    } else {\n      i = this.length;\n    } // Zeroify rest\n\n\n    this.length = Math.max(this.length, len);\n\n    for (; i < this.length; i++) {\n      this.words[i] = 0;\n    }\n\n    var carry = 0;\n\n    for (var i = 0; i < num.length; i++) {\n      var w = this.words[i + shift] + carry;\n      var right = num.words[i] * mul;\n      w -= right & 0x3ffffff;\n      carry = (w >> 26) - (right / 0x4000000 | 0);\n      this.words[i + shift] = w & 0x3ffffff;\n    }\n\n    for (; i < this.length - shift; i++) {\n      var w = this.words[i + shift] + carry;\n      carry = w >> 26;\n      this.words[i + shift] = w & 0x3ffffff;\n    }\n\n    if (carry === 0) return this.strip(); // Subtraction overflow\n\n    assert(carry === -1);\n    carry = 0;\n\n    for (var i = 0; i < this.length; i++) {\n      var w = -this.words[i] + carry;\n      carry = w >> 26;\n      this.words[i] = w & 0x3ffffff;\n    }\n\n    this.sign = true;\n    return this.strip();\n  };\n\n  BN.prototype._wordDiv = function _wordDiv(num, mode) {\n    var shift = this.length - num.length;\n    var a = this.clone();\n    var b = num; // Normalize\n\n    var bhi = b.words[b.length - 1];\n\n    var bhiBits = this._countBits(bhi);\n\n    shift = 26 - bhiBits;\n\n    if (shift !== 0) {\n      b = b.shln(shift);\n      a.ishln(shift);\n      bhi = b.words[b.length - 1];\n    } // Initialize quotient\n\n\n    var m = a.length - b.length;\n    var q;\n\n    if (mode !== 'mod') {\n      q = new BN(null);\n      q.length = m + 1;\n      q.words = new Array(q.length);\n\n      for (var i = 0; i < q.length; i++) {\n        q.words[i] = 0;\n      }\n    }\n\n    var diff = a.clone()._ishlnsubmul(b, 1, m);\n\n    if (!diff.sign) {\n      a = diff;\n      if (q) q.words[m] = 1;\n    }\n\n    for (var j = m - 1; j >= 0; j--) {\n      var qj = a.words[b.length + j] * 0x4000000 + a.words[b.length + j - 1]; // NOTE: (qj / bhi) is (0x3ffffff * 0x4000000 + 0x3ffffff) / 0x2000000 max\n      // (0x7ffffff)\n\n      qj = Math.min(qj / bhi | 0, 0x3ffffff);\n\n      a._ishlnsubmul(b, qj, j);\n\n      while (a.sign) {\n        qj--;\n        a.sign = false;\n\n        a._ishlnsubmul(b, 1, j);\n\n        if (a.cmpn(0) !== 0) a.sign = !a.sign;\n      }\n\n      if (q) q.words[j] = qj;\n    }\n\n    if (q) q.strip();\n    a.strip(); // Denormalize\n\n    if (mode !== 'div' && shift !== 0) a.ishrn(shift);\n    return {\n      div: q ? q : null,\n      mod: a\n    };\n  };\n\n  BN.prototype.divmod = function divmod(num, mode) {\n    assert(num.cmpn(0) !== 0);\n\n    if (this.sign && !num.sign) {\n      var res = this.neg().divmod(num, mode);\n      var div;\n      var mod;\n      if (mode !== 'mod') div = res.div.neg();\n      if (mode !== 'div') mod = res.mod.cmpn(0) === 0 ? res.mod : num.sub(res.mod);\n      return {\n        div: div,\n        mod: mod\n      };\n    } else if (!this.sign && num.sign) {\n      var res = this.divmod(num.neg(), mode);\n      var div;\n      if (mode !== 'mod') div = res.div.neg();\n      return {\n        div: div,\n        mod: res.mod\n      };\n    } else if (this.sign && num.sign) {\n      return this.neg().divmod(num.neg(), mode);\n    } // Both numbers are positive at this point\n    // Strip both numbers to approximate shift value\n\n\n    if (num.length > this.length || this.cmp(num) < 0) return {\n      div: new BN(0),\n      mod: this\n    }; // Very short reduction\n\n    if (num.length === 1) {\n      if (mode === 'div') return {\n        div: this.divn(num.words[0]),\n        mod: null\n      };else if (mode === 'mod') return {\n        div: null,\n        mod: new BN(this.modn(num.words[0]))\n      };\n      return {\n        div: this.divn(num.words[0]),\n        mod: new BN(this.modn(num.words[0]))\n      };\n    }\n\n    return this._wordDiv(num, mode);\n  }; // Find `this` / `num`\n\n\n  BN.prototype.div = function div(num) {\n    return this.divmod(num, 'div').div;\n  }; // Find `this` % `num`\n\n\n  BN.prototype.mod = function mod(num) {\n    return this.divmod(num, 'mod').mod;\n  }; // Find Round(`this` / `num`)\n\n\n  BN.prototype.divRound = function divRound(num) {\n    var dm = this.divmod(num); // Fast case - exact division\n\n    if (dm.mod.cmpn(0) === 0) return dm.div;\n    var mod = dm.div.sign ? dm.mod.isub(num) : dm.mod;\n    var half = num.shrn(1);\n    var r2 = num.andln(1);\n    var cmp = mod.cmp(half); // Round down\n\n    if (cmp < 0 || r2 === 1 && cmp === 0) return dm.div; // Round up\n\n    return dm.div.sign ? dm.div.isubn(1) : dm.div.iaddn(1);\n  };\n\n  BN.prototype.modn = function modn(num) {\n    assert(num <= 0x3ffffff);\n    var p = (1 << 26) % num;\n    var acc = 0;\n\n    for (var i = this.length - 1; i >= 0; i--) {\n      acc = (p * acc + this.words[i]) % num;\n    }\n\n    return acc;\n  }; // In-place division by number\n\n\n  BN.prototype.idivn = function idivn(num) {\n    assert(num <= 0x3ffffff);\n    var carry = 0;\n\n    for (var i = this.length - 1; i >= 0; i--) {\n      var w = this.words[i] + carry * 0x4000000;\n      this.words[i] = w / num | 0;\n      carry = w % num;\n    }\n\n    return this.strip();\n  };\n\n  BN.prototype.divn = function divn(num) {\n    return this.clone().idivn(num);\n  };\n\n  BN.prototype.egcd = function egcd(p) {\n    assert(!p.sign);\n    assert(p.cmpn(0) !== 0);\n    var x = this;\n    var y = p.clone();\n    if (x.sign) x = x.mod(p);else x = x.clone(); // A * x + B * y = x\n\n    var A = new BN(1);\n    var B = new BN(0); // C * x + D * y = y\n\n    var C = new BN(0);\n    var D = new BN(1);\n    var g = 0;\n\n    while (x.isEven() && y.isEven()) {\n      x.ishrn(1);\n      y.ishrn(1);\n      ++g;\n    }\n\n    var yp = y.clone();\n    var xp = x.clone();\n\n    while (x.cmpn(0) !== 0) {\n      while (x.isEven()) {\n        x.ishrn(1);\n\n        if (A.isEven() && B.isEven()) {\n          A.ishrn(1);\n          B.ishrn(1);\n        } else {\n          A.iadd(yp).ishrn(1);\n          B.isub(xp).ishrn(1);\n        }\n      }\n\n      while (y.isEven()) {\n        y.ishrn(1);\n\n        if (C.isEven() && D.isEven()) {\n          C.ishrn(1);\n          D.ishrn(1);\n        } else {\n          C.iadd(yp).ishrn(1);\n          D.isub(xp).ishrn(1);\n        }\n      }\n\n      if (x.cmp(y) >= 0) {\n        x.isub(y);\n        A.isub(C);\n        B.isub(D);\n      } else {\n        y.isub(x);\n        C.isub(A);\n        D.isub(B);\n      }\n    }\n\n    return {\n      a: C,\n      b: D,\n      gcd: y.ishln(g)\n    };\n  }; // This is reduced incarnation of the binary EEA\n  // above, designated to invert members of the\n  // _prime_ fields F(p) at a maximal speed\n\n\n  BN.prototype._invmp = function _invmp(p) {\n    assert(!p.sign);\n    assert(p.cmpn(0) !== 0);\n    var a = this;\n    var b = p.clone();\n    if (a.sign) a = a.mod(p);else a = a.clone();\n    var x1 = new BN(1);\n    var x2 = new BN(0);\n    var delta = b.clone();\n\n    while (a.cmpn(1) > 0 && b.cmpn(1) > 0) {\n      while (a.isEven()) {\n        a.ishrn(1);\n        if (x1.isEven()) x1.ishrn(1);else x1.iadd(delta).ishrn(1);\n      }\n\n      while (b.isEven()) {\n        b.ishrn(1);\n        if (x2.isEven()) x2.ishrn(1);else x2.iadd(delta).ishrn(1);\n      }\n\n      if (a.cmp(b) >= 0) {\n        a.isub(b);\n        x1.isub(x2);\n      } else {\n        b.isub(a);\n        x2.isub(x1);\n      }\n    }\n\n    if (a.cmpn(1) === 0) return x1;else return x2;\n  };\n\n  BN.prototype.gcd = function gcd(num) {\n    if (this.cmpn(0) === 0) return num.clone();\n    if (num.cmpn(0) === 0) return this.clone();\n    var a = this.clone();\n    var b = num.clone();\n    a.sign = false;\n    b.sign = false; // Remove common factor of two\n\n    for (var shift = 0; a.isEven() && b.isEven(); shift++) {\n      a.ishrn(1);\n      b.ishrn(1);\n    }\n\n    do {\n      while (a.isEven()) {\n        a.ishrn(1);\n      }\n\n      while (b.isEven()) {\n        b.ishrn(1);\n      }\n\n      var r = a.cmp(b);\n\n      if (r < 0) {\n        // Swap `a` and `b` to make `a` always bigger than `b`\n        var t = a;\n        a = b;\n        b = t;\n      } else if (r === 0 || b.cmpn(1) === 0) {\n        break;\n      }\n\n      a.isub(b);\n    } while (true);\n\n    return b.ishln(shift);\n  }; // Invert number in the field F(num)\n\n\n  BN.prototype.invm = function invm(num) {\n    return this.egcd(num).a.mod(num);\n  };\n\n  BN.prototype.isEven = function isEven() {\n    return (this.words[0] & 1) === 0;\n  };\n\n  BN.prototype.isOdd = function isOdd() {\n    return (this.words[0] & 1) === 1;\n  }; // And first word and num\n\n\n  BN.prototype.andln = function andln(num) {\n    return this.words[0] & num;\n  }; // Increment at the bit position in-line\n\n\n  BN.prototype.bincn = function bincn(bit) {\n    assert(typeof bit === 'number');\n    var r = bit % 26;\n    var s = (bit - r) / 26;\n    var q = 1 << r; // Fast case: bit is much higher than all existing words\n\n    if (this.length <= s) {\n      for (var i = this.length; i < s + 1; i++) {\n        this.words[i] = 0;\n      }\n\n      this.words[s] |= q;\n      this.length = s + 1;\n      return this;\n    } // Add bit and propagate, if needed\n\n\n    var carry = q;\n\n    for (var i = s; carry !== 0 && i < this.length; i++) {\n      var w = this.words[i];\n      w += carry;\n      carry = w >>> 26;\n      w &= 0x3ffffff;\n      this.words[i] = w;\n    }\n\n    if (carry !== 0) {\n      this.words[i] = carry;\n      this.length++;\n    }\n\n    return this;\n  };\n\n  BN.prototype.cmpn = function cmpn(num) {\n    var sign = num < 0;\n    if (sign) num = -num;\n    if (this.sign && !sign) return -1;else if (!this.sign && sign) return 1;\n    num &= 0x3ffffff;\n    this.strip();\n    var res;\n\n    if (this.length > 1) {\n      res = 1;\n    } else {\n      var w = this.words[0];\n      res = w === num ? 0 : w < num ? -1 : 1;\n    }\n\n    if (this.sign) res = -res;\n    return res;\n  }; // Compare two numbers and return:\n  // 1 - if `this` > `num`\n  // 0 - if `this` == `num`\n  // -1 - if `this` < `num`\n\n\n  BN.prototype.cmp = function cmp(num) {\n    if (this.sign && !num.sign) return -1;else if (!this.sign && num.sign) return 1;\n    var res = this.ucmp(num);\n    if (this.sign) return -res;else return res;\n  }; // Unsigned comparison\n\n\n  BN.prototype.ucmp = function ucmp(num) {\n    // At this point both numbers have the same sign\n    if (this.length > num.length) return 1;else if (this.length < num.length) return -1;\n    var res = 0;\n\n    for (var i = this.length - 1; i >= 0; i--) {\n      var a = this.words[i];\n      var b = num.words[i];\n      if (a === b) continue;\n      if (a < b) res = -1;else if (a > b) res = 1;\n      break;\n    }\n\n    return res;\n  }; //\n  // A reduce context, could be using montgomery or something better, depending\n  // on the `m` itself.\n  //\n\n\n  BN.red = function red(num) {\n    return new Red(num);\n  };\n\n  BN.prototype.toRed = function toRed(ctx) {\n    assert(!this.red, 'Already a number in reduction context');\n    assert(!this.sign, 'red works only with positives');\n    return ctx.convertTo(this)._forceRed(ctx);\n  };\n\n  BN.prototype.fromRed = function fromRed() {\n    assert(this.red, 'fromRed works only with numbers in reduction context');\n    return this.red.convertFrom(this);\n  };\n\n  BN.prototype._forceRed = function _forceRed(ctx) {\n    this.red = ctx;\n    return this;\n  };\n\n  BN.prototype.forceRed = function forceRed(ctx) {\n    assert(!this.red, 'Already a number in reduction context');\n    return this._forceRed(ctx);\n  };\n\n  BN.prototype.redAdd = function redAdd(num) {\n    assert(this.red, 'redAdd works only with red numbers');\n    return this.red.add(this, num);\n  };\n\n  BN.prototype.redIAdd = function redIAdd(num) {\n    assert(this.red, 'redIAdd works only with red numbers');\n    return this.red.iadd(this, num);\n  };\n\n  BN.prototype.redSub = function redSub(num) {\n    assert(this.red, 'redSub works only with red numbers');\n    return this.red.sub(this, num);\n  };\n\n  BN.prototype.redISub = function redISub(num) {\n    assert(this.red, 'redISub works only with red numbers');\n    return this.red.isub(this, num);\n  };\n\n  BN.prototype.redShl = function redShl(num) {\n    assert(this.red, 'redShl works only with red numbers');\n    return this.red.shl(this, num);\n  };\n\n  BN.prototype.redMul = function redMul(num) {\n    assert(this.red, 'redMul works only with red numbers');\n\n    this.red._verify2(this, num);\n\n    return this.red.mul(this, num);\n  };\n\n  BN.prototype.redIMul = function redIMul(num) {\n    assert(this.red, 'redMul works only with red numbers');\n\n    this.red._verify2(this, num);\n\n    return this.red.imul(this, num);\n  };\n\n  BN.prototype.redSqr = function redSqr() {\n    assert(this.red, 'redSqr works only with red numbers');\n\n    this.red._verify1(this);\n\n    return this.red.sqr(this);\n  };\n\n  BN.prototype.redISqr = function redISqr() {\n    assert(this.red, 'redISqr works only with red numbers');\n\n    this.red._verify1(this);\n\n    return this.red.isqr(this);\n  }; // Square root over p\n\n\n  BN.prototype.redSqrt = function redSqrt() {\n    assert(this.red, 'redSqrt works only with red numbers');\n\n    this.red._verify1(this);\n\n    return this.red.sqrt(this);\n  };\n\n  BN.prototype.redInvm = function redInvm() {\n    assert(this.red, 'redInvm works only with red numbers');\n\n    this.red._verify1(this);\n\n    return this.red.invm(this);\n  }; // Return negative clone of `this` % `red modulo`\n\n\n  BN.prototype.redNeg = function redNeg() {\n    assert(this.red, 'redNeg works only with red numbers');\n\n    this.red._verify1(this);\n\n    return this.red.neg(this);\n  };\n\n  BN.prototype.redPow = function redPow(num) {\n    assert(this.red && !num.red, 'redPow(normalNum)');\n\n    this.red._verify1(this);\n\n    return this.red.pow(this, num);\n  }; // Prime numbers with efficient reduction\n\n\n  var primes = {\n    k256: null,\n    p224: null,\n    p192: null,\n    p25519: null\n  }; // Pseudo-Mersenne prime\n\n  function MPrime(name, p) {\n    // P = 2 ^ N - K\n    this.name = name;\n    this.p = new BN(p, 16);\n    this.n = this.p.bitLength();\n    this.k = new BN(1).ishln(this.n).isub(this.p);\n    this.tmp = this._tmp();\n  }\n\n  MPrime.prototype._tmp = function _tmp() {\n    var tmp = new BN(null);\n    tmp.words = new Array(Math.ceil(this.n / 13));\n    return tmp;\n  };\n\n  MPrime.prototype.ireduce = function ireduce(num) {\n    // Assumes that `num` is less than `P^2`\n    // num = HI * (2 ^ N - K) + HI * K + LO = HI * K + LO (mod P)\n    var r = num;\n    var rlen;\n\n    do {\n      this.split(r, this.tmp);\n      r = this.imulK(r);\n      r = r.iadd(this.tmp);\n      rlen = r.bitLength();\n    } while (rlen > this.n);\n\n    var cmp = rlen < this.n ? -1 : r.ucmp(this.p);\n\n    if (cmp === 0) {\n      r.words[0] = 0;\n      r.length = 1;\n    } else if (cmp > 0) {\n      r.isub(this.p);\n    } else {\n      r.strip();\n    }\n\n    return r;\n  };\n\n  MPrime.prototype.split = function split(input, out) {\n    input.ishrn(this.n, 0, out);\n  };\n\n  MPrime.prototype.imulK = function imulK(num) {\n    return num.imul(this.k);\n  };\n\n  function K256() {\n    MPrime.call(this, 'k256', 'ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f');\n  }\n\n  inherits(K256, MPrime);\n\n  K256.prototype.split = function split(input, output) {\n    // 256 = 9 * 26 + 22\n    var mask = 0x3fffff;\n    var outLen = Math.min(input.length, 9);\n\n    for (var i = 0; i < outLen; i++) {\n      output.words[i] = input.words[i];\n    }\n\n    output.length = outLen;\n\n    if (input.length <= 9) {\n      input.words[0] = 0;\n      input.length = 1;\n      return;\n    } // Shift by 9 limbs\n\n\n    var prev = input.words[9];\n    output.words[output.length++] = prev & mask;\n\n    for (var i = 10; i < input.length; i++) {\n      var next = input.words[i];\n      input.words[i - 10] = (next & mask) << 4 | prev >>> 22;\n      prev = next;\n    }\n\n    input.words[i - 10] = prev >>> 22;\n    input.length -= 9;\n  };\n\n  K256.prototype.imulK = function imulK(num) {\n    // K = 0x1000003d1 = [ 0x40, 0x3d1 ]\n    num.words[num.length] = 0;\n    num.words[num.length + 1] = 0;\n    num.length += 2; // bounded at: 0x40 * 0x3ffffff + 0x3d0 = 0x100000390\n\n    var hi;\n    var lo = 0;\n\n    for (var i = 0; i < num.length; i++) {\n      var w = num.words[i];\n      hi = w * 0x40;\n      lo += w * 0x3d1;\n      hi += lo / 0x4000000 | 0;\n      lo &= 0x3ffffff;\n      num.words[i] = lo;\n      lo = hi;\n    } // Fast length reduction\n\n\n    if (num.words[num.length - 1] === 0) {\n      num.length--;\n      if (num.words[num.length - 1] === 0) num.length--;\n    }\n\n    return num;\n  };\n\n  function P224() {\n    MPrime.call(this, 'p224', 'ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001');\n  }\n\n  inherits(P224, MPrime);\n\n  function P192() {\n    MPrime.call(this, 'p192', 'ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff');\n  }\n\n  inherits(P192, MPrime);\n\n  function P25519() {\n    // 2 ^ 255 - 19\n    MPrime.call(this, '25519', '7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed');\n  }\n\n  inherits(P25519, MPrime);\n\n  P25519.prototype.imulK = function imulK(num) {\n    // K = 0x13\n    var carry = 0;\n\n    for (var i = 0; i < num.length; i++) {\n      var hi = num.words[i] * 0x13 + carry;\n      var lo = hi & 0x3ffffff;\n      hi >>>= 26;\n      num.words[i] = lo;\n      carry = hi;\n    }\n\n    if (carry !== 0) num.words[num.length++] = carry;\n    return num;\n  }; // Exported mostly for testing purposes, use plain name instead\n\n\n  BN._prime = function prime(name) {\n    // Cached version of prime\n    if (primes[name]) return primes[name];\n    var prime;\n    if (name === 'k256') prime = new K256();else if (name === 'p224') prime = new P224();else if (name === 'p192') prime = new P192();else if (name === 'p25519') prime = new P25519();else throw new Error('Unknown prime ' + name);\n    primes[name] = prime;\n    return prime;\n  }; //\n  // Base reduction engine\n  //\n\n\n  function Red(m) {\n    if (typeof m === 'string') {\n      var prime = BN._prime(m);\n\n      this.m = prime.p;\n      this.prime = prime;\n    } else {\n      this.m = m;\n      this.prime = null;\n    }\n  }\n\n  Red.prototype._verify1 = function _verify1(a) {\n    assert(!a.sign, 'red works only with positives');\n    assert(a.red, 'red works only with red numbers');\n  };\n\n  Red.prototype._verify2 = function _verify2(a, b) {\n    assert(!a.sign && !b.sign, 'red works only with positives');\n    assert(a.red && a.red === b.red, 'red works only with red numbers');\n  };\n\n  Red.prototype.imod = function imod(a) {\n    if (this.prime) return this.prime.ireduce(a)._forceRed(this);\n    return a.mod(this.m)._forceRed(this);\n  };\n\n  Red.prototype.neg = function neg(a) {\n    var r = a.clone();\n    r.sign = !r.sign;\n    return r.iadd(this.m)._forceRed(this);\n  };\n\n  Red.prototype.add = function add(a, b) {\n    this._verify2(a, b);\n\n    var res = a.add(b);\n    if (res.cmp(this.m) >= 0) res.isub(this.m);\n    return res._forceRed(this);\n  };\n\n  Red.prototype.iadd = function iadd(a, b) {\n    this._verify2(a, b);\n\n    var res = a.iadd(b);\n    if (res.cmp(this.m) >= 0) res.isub(this.m);\n    return res;\n  };\n\n  Red.prototype.sub = function sub(a, b) {\n    this._verify2(a, b);\n\n    var res = a.sub(b);\n    if (res.cmpn(0) < 0) res.iadd(this.m);\n    return res._forceRed(this);\n  };\n\n  Red.prototype.isub = function isub(a, b) {\n    this._verify2(a, b);\n\n    var res = a.isub(b);\n    if (res.cmpn(0) < 0) res.iadd(this.m);\n    return res;\n  };\n\n  Red.prototype.shl = function shl(a, num) {\n    this._verify1(a);\n\n    return this.imod(a.shln(num));\n  };\n\n  Red.prototype.imul = function imul(a, b) {\n    this._verify2(a, b);\n\n    return this.imod(a.imul(b));\n  };\n\n  Red.prototype.mul = function mul(a, b) {\n    this._verify2(a, b);\n\n    return this.imod(a.mul(b));\n  };\n\n  Red.prototype.isqr = function isqr(a) {\n    return this.imul(a, a);\n  };\n\n  Red.prototype.sqr = function sqr(a) {\n    return this.mul(a, a);\n  };\n\n  Red.prototype.sqrt = function sqrt(a) {\n    if (a.cmpn(0) === 0) return a.clone();\n    var mod3 = this.m.andln(3);\n    assert(mod3 % 2 === 1); // Fast case\n\n    if (mod3 === 3) {\n      var pow = this.m.add(new BN(1)).ishrn(2);\n      var r = this.pow(a, pow);\n      return r;\n    } // Tonelli-Shanks algorithm (Totally unoptimized and slow)\n    //\n    // Find Q and S, that Q * 2 ^ S = (P - 1)\n\n\n    var q = this.m.subn(1);\n    var s = 0;\n\n    while (q.cmpn(0) !== 0 && q.andln(1) === 0) {\n      s++;\n      q.ishrn(1);\n    }\n\n    assert(q.cmpn(0) !== 0);\n    var one = new BN(1).toRed(this);\n    var nOne = one.redNeg(); // Find quadratic non-residue\n    // NOTE: Max is such because of generalized Riemann hypothesis.\n\n    var lpow = this.m.subn(1).ishrn(1);\n    var z = this.m.bitLength();\n    z = new BN(2 * z * z).toRed(this);\n\n    while (this.pow(z, lpow).cmp(nOne) !== 0) {\n      z.redIAdd(nOne);\n    }\n\n    var c = this.pow(z, q);\n    var r = this.pow(a, q.addn(1).ishrn(1));\n    var t = this.pow(a, q);\n    var m = s;\n\n    while (t.cmp(one) !== 0) {\n      var tmp = t;\n\n      for (var i = 0; tmp.cmp(one) !== 0; i++) {\n        tmp = tmp.redSqr();\n      }\n\n      assert(i < m);\n      var b = this.pow(c, new BN(1).ishln(m - i - 1));\n      r = r.redMul(b);\n      c = b.redSqr();\n      t = t.redMul(c);\n      m = i;\n    }\n\n    return r;\n  };\n\n  Red.prototype.invm = function invm(a) {\n    var inv = a._invmp(this.m);\n\n    if (inv.sign) {\n      inv.sign = false;\n      return this.imod(inv).redNeg();\n    } else {\n      return this.imod(inv);\n    }\n  };\n\n  Red.prototype.pow = function pow(a, num) {\n    var w = [];\n    if (num.cmpn(0) === 0) return new BN(1);\n    var q = num.clone();\n\n    while (q.cmpn(0) !== 0) {\n      w.push(q.andln(1));\n      q.ishrn(1);\n    } // Skip leading zeroes\n\n\n    var res = a;\n\n    for (var i = 0; i < w.length; i++, res = this.sqr(res)) {\n      if (w[i] !== 0) break;\n    }\n\n    if (++i < w.length) {\n      for (var q = this.sqr(res); i < w.length; i++, q = this.sqr(q)) {\n        if (w[i] === 0) continue;\n        res = this.mul(res, q);\n      }\n    }\n\n    return res;\n  };\n\n  Red.prototype.convertTo = function convertTo(num) {\n    var r = num.mod(this.m);\n    if (r === num) return r.clone();else return r;\n  };\n\n  Red.prototype.convertFrom = function convertFrom(num) {\n    var res = num.clone();\n    res.red = null;\n    return res;\n  }; //\n  // Montgomery method engine\n  //\n\n\n  BN.mont = function mont(num) {\n    return new Mont(num);\n  };\n\n  function Mont(m) {\n    Red.call(this, m);\n    this.shift = this.m.bitLength();\n    if (this.shift % 26 !== 0) this.shift += 26 - this.shift % 26;\n    this.r = new BN(1).ishln(this.shift);\n    this.r2 = this.imod(this.r.sqr());\n    this.rinv = this.r._invmp(this.m);\n    this.minv = this.rinv.mul(this.r).isubn(1).div(this.m);\n    this.minv.sign = true;\n    this.minv = this.minv.mod(this.r);\n  }\n\n  inherits(Mont, Red);\n\n  Mont.prototype.convertTo = function convertTo(num) {\n    return this.imod(num.shln(this.shift));\n  };\n\n  Mont.prototype.convertFrom = function convertFrom(num) {\n    var r = this.imod(num.mul(this.rinv));\n    r.red = null;\n    return r;\n  };\n\n  Mont.prototype.imul = function imul(a, b) {\n    if (a.cmpn(0) === 0 || b.cmpn(0) === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    var t = a.imul(b);\n    var c = t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);\n    var u = t.isub(c).ishrn(this.shift);\n    var res = u;\n    if (u.cmp(this.m) >= 0) res = u.isub(this.m);else if (u.cmpn(0) < 0) res = u.iadd(this.m);\n    return res._forceRed(this);\n  };\n\n  Mont.prototype.mul = function mul(a, b) {\n    if (a.cmpn(0) === 0 || b.cmpn(0) === 0) return new BN(0)._forceRed(this);\n    var t = a.mul(b);\n    var c = t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);\n    var u = t.isub(c).ishrn(this.shift);\n    var res = u;\n    if (u.cmp(this.m) >= 0) res = u.isub(this.m);else if (u.cmpn(0) < 0) res = u.iadd(this.m);\n    return res._forceRed(this);\n  };\n\n  Mont.prototype.invm = function invm(a) {\n    // (AR)^-1 * R^2 = (A^-1 * R^-1) * R^2 = A^-1 * R\n    var res = this.imod(a._invmp(this.m).mul(this.r2));\n    return res._forceRed(this);\n  };\n})(typeof module === 'undefined' || module, this);","map":{"version":3,"sources":["/Users/anthonypafundi/Desktop/baseapp/node_modules/bitcoincashjs/node_modules/elliptic/node_modules/bn.js/lib/bn.js"],"names":["module","exports","assert","val","msg","Error","inherits","ctor","superCtor","super_","TempCtor","prototype","constructor","BN","number","base","endian","Array","isArray","words","sign","length","red","_init","wordSize","init","_initNumber","_initArray","toString","replace","start","_parseHex","_parseBase","strip","toArray","Math","ceil","i","off","j","w","parseHex","str","end","r","len","min","c","charCodeAt","parseBase","mul","limbLen","limbPow","total","mod","word","imuln","_iaddn","pow","copy","dest","clone","_normSign","inspect","zeros","groupSizes","groupBases","padding","out","carry","groupSize","groupBase","cmpn","modn","idivn","toJSON","res","byteLength","q","b","andln","ishrn","clz32","_countBits","t","_zeroBits","bitLength","hi","zeroBits","neg","ior","num","or","iand","and","ixor","a","xor","setn","bit","wbit","iadd","isub","add","sub","cmp","max","_smallMulTo","k","ncarry","rword","maxJ","lo","_bigMulTo","hncarry","mulTo","imul","tlen","nlen","muln","sqr","isqr","ishln","bits","s","carryMask","newCarry","hint","extended","h","mask","maskedWords","shln","shrn","testn","imaskn","maskn","iaddn","isubn","addn","subn","iabs","abs","_ishlnsubmul","shift","right","_wordDiv","mode","bhi","bhiBits","m","diff","qj","div","divmod","divn","divRound","dm","half","r2","p","acc","egcd","x","y","A","B","C","D","g","isEven","yp","xp","gcd","_invmp","x1","x2","delta","invm","isOdd","bincn","ucmp","Red","toRed","ctx","convertTo","_forceRed","fromRed","convertFrom","forceRed","redAdd","redIAdd","redSub","redISub","redShl","shl","redMul","_verify2","redIMul","redSqr","_verify1","redISqr","redSqrt","sqrt","redInvm","redNeg","redPow","primes","k256","p224","p192","p25519","MPrime","name","n","tmp","_tmp","ireduce","rlen","split","imulK","input","K256","call","output","outLen","prev","next","P224","P192","P25519","_prime","prime","imod","mod3","one","nOne","lpow","z","inv","push","mont","Mont","rinv","minv","u"],"mappings":"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","sourcesContent":["(function (module, exports) {\n\n'use strict';\n\n// Utils\n\nfunction assert(val, msg) {\n  if (!val)\n    throw new Error(msg || 'Assertion failed');\n}\n\n// Could use `inherits` module, but don't want to move from single file\n// architecture yet.\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  var TempCtor = function () {};\n  TempCtor.prototype = superCtor.prototype;\n  ctor.prototype = new TempCtor();\n  ctor.prototype.constructor = ctor;\n}\n\n// BN\n\nfunction BN(number, base, endian) {\n  // May be `new BN(bn)` ?\n  if (number !== null &&\n      typeof number === 'object' &&\n      Array.isArray(number.words)) {\n    return number;\n  }\n\n  this.sign = false;\n  this.words = null;\n  this.length = 0;\n\n  // Reduction context\n  this.red = null;\n\n  if (base === 'le' || base === 'be') {\n    endian = base;\n    base = 10;\n  }\n\n  if (number !== null)\n    this._init(number || 0, base || 10, endian || 'be');\n}\nif (typeof module === 'object')\n  module.exports = BN;\nelse\n  exports.BN = BN;\n\nBN.BN = BN;\nBN.wordSize = 26;\n\nBN.prototype._init = function init(number, base, endian) {\n  if (typeof number === 'number') {\n    return this._initNumber(number, base, endian);\n  } else if (typeof number === 'object') {\n    return this._initArray(number, base, endian);\n  }\n  if (base === 'hex')\n    base = 16;\n  assert(base === (base | 0) && base >= 2 && base <= 36);\n\n  number = number.toString().replace(/\\s+/g, '');\n  var start = 0;\n  if (number[0] === '-')\n    start++;\n\n  if (base === 16)\n    this._parseHex(number, start);\n  else\n    this._parseBase(number, base, start);\n\n  if (number[0] === '-')\n    this.sign = true;\n\n  this.strip();\n\n  if (endian !== 'le')\n    return;\n\n  this._initArray(this.toArray(), base, endian);\n};\n\nBN.prototype._initNumber = function _initNumber(number, base, endian) {\n  if (number < 0) {\n    this.sign = true;\n    number = -number;\n  }\n  if (number < 0x4000000) {\n    this.words = [ number & 0x3ffffff ];\n    this.length = 1;\n  } else if (number < 0x10000000000000) {\n    this.words = [\n      number & 0x3ffffff,\n      (number / 0x4000000) & 0x3ffffff\n    ];\n    this.length = 2;\n  } else {\n    assert(number < 0x20000000000000); // 2 ^ 53 (unsafe)\n    this.words = [\n      number & 0x3ffffff,\n      (number / 0x4000000) & 0x3ffffff,\n      1\n    ];\n    this.length = 3;\n  }\n\n  if (endian !== 'le')\n    return;\n\n  // Reverse the bytes\n  this._initArray(this.toArray(), base, endian);\n};\n\nBN.prototype._initArray = function _initArray(number, base, endian) {\n  // Perhaps a Uint8Array\n  assert(typeof number.length === 'number');\n  if (number.length <= 0) {\n    this.words = [ 0 ];\n    this.length = 1;\n    return this;\n  }\n\n  this.length = Math.ceil(number.length / 3);\n  this.words = new Array(this.length);\n  for (var i = 0; i < this.length; i++)\n    this.words[i] = 0;\n\n  var off = 0;\n  if (endian === 'be') {\n    for (var i = number.length - 1, j = 0; i >= 0; i -= 3) {\n      var w = number[i] | (number[i - 1] << 8) | (number[i - 2] << 16);\n      this.words[j] |= (w << off) & 0x3ffffff;\n      this.words[j + 1] = (w >>> (26 - off)) & 0x3ffffff;\n      off += 24;\n      if (off >= 26) {\n        off -= 26;\n        j++;\n      }\n    }\n  } else if (endian === 'le') {\n    for (var i = 0, j = 0; i < number.length; i += 3) {\n      var w = number[i] | (number[i + 1] << 8) | (number[i + 2] << 16);\n      this.words[j] |= (w << off) & 0x3ffffff;\n      this.words[j + 1] = (w >>> (26 - off)) & 0x3ffffff;\n      off += 24;\n      if (off >= 26) {\n        off -= 26;\n        j++;\n      }\n    }\n  }\n  return this.strip();\n};\n\nfunction parseHex(str, start, end) {\n  var r = 0;\n  var len = Math.min(str.length, end);\n  for (var i = start; i < len; i++) {\n    var c = str.charCodeAt(i) - 48;\n\n    r <<= 4;\n\n    // 'a' - 'f'\n    if (c >= 49 && c <= 54)\n      r |= c - 49 + 0xa;\n\n    // 'A' - 'F'\n    else if (c >= 17 && c <= 22)\n      r |= c - 17 + 0xa;\n\n    // '0' - '9'\n    else\n      r |= c & 0xf;\n  }\n  return r;\n}\n\nBN.prototype._parseHex = function _parseHex(number, start) {\n  // Create possibly bigger array to ensure that it fits the number\n  this.length = Math.ceil((number.length - start) / 6);\n  this.words = new Array(this.length);\n  for (var i = 0; i < this.length; i++)\n    this.words[i] = 0;\n\n  // Scan 24-bit chunks and add them to the number\n  var off = 0;\n  for (var i = number.length - 6, j = 0; i >= start; i -= 6) {\n    var w = parseHex(number, i, i + 6);\n    this.words[j] |= (w << off) & 0x3ffffff;\n    this.words[j + 1] |= w >>> (26 - off) & 0x3fffff;\n    off += 24;\n    if (off >= 26) {\n      off -= 26;\n      j++;\n    }\n  }\n  if (i + 6 !== start) {\n    var w = parseHex(number, start, i + 6);\n    this.words[j] |= (w << off) & 0x3ffffff;\n    this.words[j + 1] |= w >>> (26 - off) & 0x3fffff;\n  }\n  this.strip();\n};\n\nfunction parseBase(str, start, end, mul) {\n  var r = 0;\n  var len = Math.min(str.length, end);\n  for (var i = start; i < len; i++) {\n    var c = str.charCodeAt(i) - 48;\n\n    r *= mul;\n\n    // 'a'\n    if (c >= 49)\n      r += c - 49 + 0xa;\n\n    // 'A'\n    else if (c >= 17)\n      r += c - 17 + 0xa;\n\n    // '0' - '9'\n    else\n      r += c;\n  }\n  return r;\n}\n\nBN.prototype._parseBase = function _parseBase(number, base, start) {\n  // Initialize as zero\n  this.words = [ 0 ];\n  this.length = 1;\n\n  // Find length of limb in base\n  for (var limbLen = 0, limbPow = 1; limbPow <= 0x3ffffff; limbPow *= base)\n    limbLen++;\n  limbLen--;\n  limbPow = (limbPow / base) | 0;\n\n  var total = number.length - start;\n  var mod = total % limbLen;\n  var end = Math.min(total, total - mod) + start;\n\n  var word = 0;\n  for (var i = start; i < end; i += limbLen) {\n    word = parseBase(number, i, i + limbLen, base);\n\n    this.imuln(limbPow);\n    if (this.words[0] + word < 0x4000000)\n      this.words[0] += word;\n    else\n      this._iaddn(word);\n  }\n\n  if (mod !== 0) {\n    var pow = 1;\n    var word = parseBase(number, i, number.length, base);\n\n    for (var i = 0; i < mod; i++)\n      pow *= base;\n    this.imuln(pow);\n    if (this.words[0] + word < 0x4000000)\n      this.words[0] += word;\n    else\n      this._iaddn(word);\n  }\n};\n\nBN.prototype.copy = function copy(dest) {\n  dest.words = new Array(this.length);\n  for (var i = 0; i < this.length; i++)\n    dest.words[i] = this.words[i];\n  dest.length = this.length;\n  dest.sign = this.sign;\n  dest.red = this.red;\n};\n\nBN.prototype.clone = function clone() {\n  var r = new BN(null);\n  this.copy(r);\n  return r;\n};\n\n// Remove leading `0` from `this`\nBN.prototype.strip = function strip() {\n  while (this.length > 1 && this.words[this.length - 1] === 0)\n    this.length--;\n  return this._normSign();\n};\n\nBN.prototype._normSign = function _normSign() {\n  // -0 = 0\n  if (this.length === 1 && this.words[0] === 0)\n    this.sign = false;\n  return this;\n};\n\nBN.prototype.inspect = function inspect() {\n  return (this.red ? '<BN-R: ' : '<BN: ') + this.toString(16) + '>';\n};\n\n/*\n\nvar zeros = [];\nvar groupSizes = [];\nvar groupBases = [];\n\nvar s = '';\nvar i = -1;\nwhile (++i < BN.wordSize) {\n  zeros[i] = s;\n  s += '0';\n}\ngroupSizes[0] = 0;\ngroupSizes[1] = 0;\ngroupBases[0] = 0;\ngroupBases[1] = 0;\nvar base = 2 - 1;\nwhile (++base < 36 + 1) {\n  var groupSize = 0;\n  var groupBase = 1;\n  while (groupBase < (1 << BN.wordSize) / base) {\n    groupBase *= base;\n    groupSize += 1;\n  }\n  groupSizes[base] = groupSize;\n  groupBases[base] = groupBase;\n}\n\n*/\n\nvar zeros = [\n  '',\n  '0',\n  '00',\n  '000',\n  '0000',\n  '00000',\n  '000000',\n  '0000000',\n  '00000000',\n  '000000000',\n  '0000000000',\n  '00000000000',\n  '000000000000',\n  '0000000000000',\n  '00000000000000',\n  '000000000000000',\n  '0000000000000000',\n  '00000000000000000',\n  '000000000000000000',\n  '0000000000000000000',\n  '00000000000000000000',\n  '000000000000000000000',\n  '0000000000000000000000',\n  '00000000000000000000000',\n  '000000000000000000000000',\n  '0000000000000000000000000'\n];\n\nvar groupSizes = [\n  0, 0,\n  25, 16, 12, 11, 10, 9, 8,\n  8, 7, 7, 7, 7, 6, 6,\n  6, 6, 6, 6, 6, 5, 5,\n  5, 5, 5, 5, 5, 5, 5,\n  5, 5, 5, 5, 5, 5, 5\n];\n\nvar groupBases = [\n  0, 0,\n  33554432, 43046721, 16777216, 48828125, 60466176, 40353607, 16777216,\n  43046721, 10000000, 19487171, 35831808, 62748517, 7529536, 11390625,\n  16777216, 24137569, 34012224, 47045881, 64000000, 4084101, 5153632,\n  6436343, 7962624, 9765625, 11881376, 14348907, 17210368, 20511149,\n  24300000, 28629151, 33554432, 39135393, 45435424, 52521875, 60466176\n];\n\nBN.prototype.toString = function toString(base, padding) {\n  base = base || 10;\n  if (base === 16 || base === 'hex') {\n    var out = '';\n    var off = 0;\n    var padding = padding | 0 || 1;\n    var carry = 0;\n    for (var i = 0; i < this.length; i++) {\n      var w = this.words[i];\n      var word = (((w << off) | carry) & 0xffffff).toString(16);\n      carry = (w >>> (24 - off)) & 0xffffff;\n      if (carry !== 0 || i !== this.length - 1)\n        out = zeros[6 - word.length] + word + out;\n      else\n        out = word + out;\n      off += 2;\n      if (off >= 26) {\n        off -= 26;\n        i--;\n      }\n    }\n    if (carry !== 0)\n      out = carry.toString(16) + out;\n    while (out.length % padding !== 0)\n      out = '0' + out;\n    if (this.sign)\n      out = '-' + out;\n    return out;\n  } else if (base === (base | 0) && base >= 2 && base <= 36) {\n    // var groupSize = Math.floor(BN.wordSize * Math.LN2 / Math.log(base));\n    var groupSize = groupSizes[base];\n    // var groupBase = Math.pow(base, groupSize);\n    var groupBase = groupBases[base];\n    var out = '';\n    var c = this.clone();\n    c.sign = false;\n    while (c.cmpn(0) !== 0) {\n      var r = c.modn(groupBase).toString(base);\n      c = c.idivn(groupBase);\n\n      if (c.cmpn(0) !== 0)\n        out = zeros[groupSize - r.length] + r + out;\n      else\n        out = r + out;\n    }\n    if (this.cmpn(0) === 0)\n      out = '0' + out;\n    if (this.sign)\n      out = '-' + out;\n    return out;\n  } else {\n    assert(false, 'Base should be between 2 and 36');\n  }\n};\n\nBN.prototype.toJSON = function toJSON() {\n  return this.toString(16);\n};\n\nBN.prototype.toArray = function toArray(endian) {\n  this.strip();\n  var res = new Array(this.byteLength());\n  res[0] = 0;\n\n  var q = this.clone();\n  if (endian !== 'le') {\n    // Assume big-endian\n    for (var i = 0; q.cmpn(0) !== 0; i++) {\n      var b = q.andln(0xff);\n      q.ishrn(8);\n\n      res[res.length - i - 1] = b;\n    }\n  } else {\n    // Assume little-endian\n    for (var i = 0; q.cmpn(0) !== 0; i++) {\n      var b = q.andln(0xff);\n      q.ishrn(8);\n\n      res[i] = b;\n    }\n  }\n\n  return res;\n};\n\nif (Math.clz32) {\n  BN.prototype._countBits = function _countBits(w) {\n    return 32 - Math.clz32(w);\n  };\n} else {\n  BN.prototype._countBits = function _countBits(w) {\n    var t = w;\n    var r = 0;\n    if (t >= 0x1000) {\n      r += 13;\n      t >>>= 13;\n    }\n    if (t >= 0x40) {\n      r += 7;\n      t >>>= 7;\n    }\n    if (t >= 0x8) {\n      r += 4;\n      t >>>= 4;\n    }\n    if (t >= 0x02) {\n      r += 2;\n      t >>>= 2;\n    }\n    return r + t;\n  };\n}\n\nBN.prototype._zeroBits = function _zeroBits(w) {\n  // Short-cut\n  if (w === 0)\n    return 26;\n\n  var t = w;\n  var r = 0;\n  if ((t & 0x1fff) === 0) {\n    r += 13;\n    t >>>= 13;\n  }\n  if ((t & 0x7f) === 0) {\n    r += 7;\n    t >>>= 7;\n  }\n  if ((t & 0xf) === 0) {\n    r += 4;\n    t >>>= 4;\n  }\n  if ((t & 0x3) === 0) {\n    r += 2;\n    t >>>= 2;\n  }\n  if ((t & 0x1) === 0)\n    r++;\n  return r;\n};\n\n// Return number of used bits in a BN\nBN.prototype.bitLength = function bitLength() {\n  var hi = 0;\n  var w = this.words[this.length - 1];\n  var hi = this._countBits(w);\n  return (this.length - 1) * 26 + hi;\n};\n\n// Number of trailing zero bits\nBN.prototype.zeroBits = function zeroBits() {\n  if (this.cmpn(0) === 0)\n    return 0;\n\n  var r = 0;\n  for (var i = 0; i < this.length; i++) {\n    var b = this._zeroBits(this.words[i]);\n    r += b;\n    if (b !== 26)\n      break;\n  }\n  return r;\n};\n\nBN.prototype.byteLength = function byteLength() {\n  return Math.ceil(this.bitLength() / 8);\n};\n\n// Return negative clone of `this`\nBN.prototype.neg = function neg() {\n  if (this.cmpn(0) === 0)\n    return this.clone();\n\n  var r = this.clone();\n  r.sign = !this.sign;\n  return r;\n};\n\n\n// Or `num` with `this` in-place\nBN.prototype.ior = function ior(num) {\n  this.sign = this.sign || num.sign;\n\n  while (this.length < num.length)\n    this.words[this.length++] = 0;\n\n  for (var i = 0; i < num.length; i++)\n    this.words[i] = this.words[i] | num.words[i];\n\n  return this.strip();\n};\n\n\n// Or `num` with `this`\nBN.prototype.or = function or(num) {\n  if (this.length > num.length)\n    return this.clone().ior(num);\n  else\n    return num.clone().ior(this);\n};\n\n\n// And `num` with `this` in-place\nBN.prototype.iand = function iand(num) {\n  this.sign = this.sign && num.sign;\n\n  // b = min-length(num, this)\n  var b;\n  if (this.length > num.length)\n    b = num;\n  else\n    b = this;\n\n  for (var i = 0; i < b.length; i++)\n    this.words[i] = this.words[i] & num.words[i];\n\n  this.length = b.length;\n\n  return this.strip();\n};\n\n\n// And `num` with `this`\nBN.prototype.and = function and(num) {\n  if (this.length > num.length)\n    return this.clone().iand(num);\n  else\n    return num.clone().iand(this);\n};\n\n\n// Xor `num` with `this` in-place\nBN.prototype.ixor = function ixor(num) {\n  this.sign = this.sign || num.sign;\n\n  // a.length > b.length\n  var a;\n  var b;\n  if (this.length > num.length) {\n    a = this;\n    b = num;\n  } else {\n    a = num;\n    b = this;\n  }\n\n  for (var i = 0; i < b.length; i++)\n    this.words[i] = a.words[i] ^ b.words[i];\n\n  if (this !== a)\n    for (; i < a.length; i++)\n      this.words[i] = a.words[i];\n\n  this.length = a.length;\n\n  return this.strip();\n};\n\n\n// Xor `num` with `this`\nBN.prototype.xor = function xor(num) {\n  if (this.length > num.length)\n    return this.clone().ixor(num);\n  else\n    return num.clone().ixor(this);\n};\n\n\n// Set `bit` of `this`\nBN.prototype.setn = function setn(bit, val) {\n  assert(typeof bit === 'number' && bit >= 0);\n\n  var off = (bit / 26) | 0;\n  var wbit = bit % 26;\n\n  while (this.length <= off)\n    this.words[this.length++] = 0;\n\n  if (val)\n    this.words[off] = this.words[off] | (1 << wbit);\n  else\n    this.words[off] = this.words[off] & ~(1 << wbit);\n\n  return this.strip();\n};\n\n\n// Add `num` to `this` in-place\nBN.prototype.iadd = function iadd(num) {\n  // negative + positive\n  if (this.sign && !num.sign) {\n    this.sign = false;\n    var r = this.isub(num);\n    this.sign = !this.sign;\n    return this._normSign();\n\n  // positive + negative\n  } else if (!this.sign && num.sign) {\n    num.sign = false;\n    var r = this.isub(num);\n    num.sign = true;\n    return r._normSign();\n  }\n\n  // a.length > b.length\n  var a;\n  var b;\n  if (this.length > num.length) {\n    a = this;\n    b = num;\n  } else {\n    a = num;\n    b = this;\n  }\n\n  var carry = 0;\n  for (var i = 0; i < b.length; i++) {\n    var r = a.words[i] + b.words[i] + carry;\n    this.words[i] = r & 0x3ffffff;\n    carry = r >>> 26;\n  }\n  for (; carry !== 0 && i < a.length; i++) {\n    var r = a.words[i] + carry;\n    this.words[i] = r & 0x3ffffff;\n    carry = r >>> 26;\n  }\n\n  this.length = a.length;\n  if (carry !== 0) {\n    this.words[this.length] = carry;\n    this.length++;\n  // Copy the rest of the words\n  } else if (a !== this) {\n    for (; i < a.length; i++)\n      this.words[i] = a.words[i];\n  }\n\n  return this;\n};\n\n// Add `num` to `this`\nBN.prototype.add = function add(num) {\n  if (num.sign && !this.sign) {\n    num.sign = false;\n    var res = this.sub(num);\n    num.sign = true;\n    return res;\n  } else if (!num.sign && this.sign) {\n    this.sign = false;\n    var res = num.sub(this);\n    this.sign = true;\n    return res;\n  }\n\n  if (this.length > num.length)\n    return this.clone().iadd(num);\n  else\n    return num.clone().iadd(this);\n};\n\n// Subtract `num` from `this` in-place\nBN.prototype.isub = function isub(num) {\n  // this - (-num) = this + num\n  if (num.sign) {\n    num.sign = false;\n    var r = this.iadd(num);\n    num.sign = true;\n    return r._normSign();\n\n  // -this - num = -(this + num)\n  } else if (this.sign) {\n    this.sign = false;\n    this.iadd(num);\n    this.sign = true;\n    return this._normSign();\n  }\n\n  // At this point both numbers are positive\n  var cmp = this.cmp(num);\n\n  // Optimization - zeroify\n  if (cmp === 0) {\n    this.sign = false;\n    this.length = 1;\n    this.words[0] = 0;\n    return this;\n  }\n\n  // a > b\n  var a;\n  var b;\n  if (cmp > 0) {\n    a = this;\n    b = num;\n  } else {\n    a = num;\n    b = this;\n  }\n\n  var carry = 0;\n  for (var i = 0; i < b.length; i++) {\n    var r = a.words[i] - b.words[i] + carry;\n    carry = r >> 26;\n    this.words[i] = r & 0x3ffffff;\n  }\n  for (; carry !== 0 && i < a.length; i++) {\n    var r = a.words[i] + carry;\n    carry = r >> 26;\n    this.words[i] = r & 0x3ffffff;\n  }\n\n  // Copy rest of the words\n  if (carry === 0 && i < a.length && a !== this)\n    for (; i < a.length; i++)\n      this.words[i] = a.words[i];\n  this.length = Math.max(this.length, i);\n\n  if (a !== this)\n    this.sign = true;\n\n  return this.strip();\n};\n\n// Subtract `num` from `this`\nBN.prototype.sub = function sub(num) {\n  return this.clone().isub(num);\n};\n\n/*\n// NOTE: This could be potentionally used to generate loop-less multiplications\nfunction _genCombMulTo(alen, blen) {\n  var len = alen + blen - 1;\n  var src = [\n    'var a = this.words, b = num.words, o = out.words, c = 0, w, ' +\n        'mask = 0x3ffffff, shift = 0x4000000;',\n    'out.length = ' + len + ';'\n  ];\n  for (var k = 0; k < len; k++) {\n    var minJ = Math.max(0, k - alen + 1);\n    var maxJ = Math.min(k, blen - 1);\n\n    for (var j = minJ; j <= maxJ; j++) {\n      var i = k - j;\n      var mul = 'a[' + i + '] * b[' + j + ']';\n\n      if (j === minJ) {\n        src.push('w = ' + mul + ' + c;');\n        src.push('c = (w / shift) | 0;');\n      } else {\n        src.push('w += ' + mul + ';');\n        src.push('c += (w / shift) | 0;');\n      }\n      src.push('w &= mask;');\n    }\n    src.push('o[' + k + '] = w;');\n  }\n  src.push('if (c !== 0) {',\n           '  o[' + k + '] = c;',\n           '  out.length++;',\n           '}',\n           'return out;');\n\n  return src.join('\\n');\n}\n*/\n\nBN.prototype._smallMulTo = function _smallMulTo(num, out) {\n  out.sign = num.sign !== this.sign;\n  out.length = this.length + num.length;\n\n  var carry = 0;\n  for (var k = 0; k < out.length - 1; k++) {\n    // Sum all words with the same `i + j = k` and accumulate `ncarry`,\n    // note that ncarry could be >= 0x3ffffff\n    var ncarry = carry >>> 26;\n    var rword = carry & 0x3ffffff;\n    var maxJ = Math.min(k, num.length - 1);\n    for (var j = Math.max(0, k - this.length + 1); j <= maxJ; j++) {\n      var i = k - j;\n      var a = this.words[i] | 0;\n      var b = num.words[j] | 0;\n      var r = a * b;\n\n      var lo = r & 0x3ffffff;\n      ncarry = (ncarry + ((r / 0x4000000) | 0)) | 0;\n      lo = (lo + rword) | 0;\n      rword = lo & 0x3ffffff;\n      ncarry = (ncarry + (lo >>> 26)) | 0;\n    }\n    out.words[k] = rword;\n    carry = ncarry;\n  }\n  if (carry !== 0) {\n    out.words[k] = carry;\n  } else {\n    out.length--;\n  }\n\n  return out.strip();\n};\n\nBN.prototype._bigMulTo = function _bigMulTo(num, out) {\n  out.sign = num.sign !== this.sign;\n  out.length = this.length + num.length;\n\n  var carry = 0;\n  var hncarry = 0;\n  for (var k = 0; k < out.length - 1; k++) {\n    // Sum all words with the same `i + j = k` and accumulate `ncarry`,\n    // note that ncarry could be >= 0x3ffffff\n    var ncarry = hncarry;\n    hncarry = 0;\n    var rword = carry & 0x3ffffff;\n    var maxJ = Math.min(k, num.length - 1);\n    for (var j = Math.max(0, k - this.length + 1); j <= maxJ; j++) {\n      var i = k - j;\n      var a = this.words[i] | 0;\n      var b = num.words[j] | 0;\n      var r = a * b;\n\n      var lo = r & 0x3ffffff;\n      ncarry = (ncarry + ((r / 0x4000000) | 0)) | 0;\n      lo = (lo + rword) | 0;\n      rword = lo & 0x3ffffff;\n      ncarry = (ncarry + (lo >>> 26)) | 0;\n\n      hncarry += ncarry >>> 26;\n      ncarry &= 0x3ffffff;\n    }\n    out.words[k] = rword;\n    carry = ncarry;\n    ncarry = hncarry;\n  }\n  if (carry !== 0) {\n    out.words[k] = carry;\n  } else {\n    out.length--;\n  }\n\n  return out.strip();\n};\n\nBN.prototype.mulTo = function mulTo(num, out) {\n  var res;\n  if (this.length + num.length < 63)\n    res = this._smallMulTo(num, out);\n  else\n    res = this._bigMulTo(num, out);\n  return res;\n};\n\n// Multiply `this` by `num`\nBN.prototype.mul = function mul(num) {\n  var out = new BN(null);\n  out.words = new Array(this.length + num.length);\n  return this.mulTo(num, out);\n};\n\n// In-place Multiplication\nBN.prototype.imul = function imul(num) {\n  if (this.cmpn(0) === 0 || num.cmpn(0) === 0) {\n    this.words[0] = 0;\n    this.length = 1;\n    return this;\n  }\n\n  var tlen = this.length;\n  var nlen = num.length;\n\n  this.sign = num.sign !== this.sign;\n  this.length = this.length + num.length;\n  this.words[this.length - 1] = 0;\n\n  for (var k = this.length - 2; k >= 0; k--) {\n    // Sum all words with the same `i + j = k` and accumulate `carry`,\n    // note that carry could be >= 0x3ffffff\n    var carry = 0;\n    var rword = 0;\n    var maxJ = Math.min(k, nlen - 1);\n    for (var j = Math.max(0, k - tlen + 1); j <= maxJ; j++) {\n      var i = k - j;\n      var a = this.words[i];\n      var b = num.words[j];\n      var r = a * b;\n\n      var lo = r & 0x3ffffff;\n      carry += (r / 0x4000000) | 0;\n      lo += rword;\n      rword = lo & 0x3ffffff;\n      carry += lo >>> 26;\n    }\n    this.words[k] = rword;\n    this.words[k + 1] += carry;\n    carry = 0;\n  }\n\n  // Propagate overflows\n  var carry = 0;\n  for (var i = 1; i < this.length; i++) {\n    var w = this.words[i] + carry;\n    this.words[i] = w & 0x3ffffff;\n    carry = w >>> 26;\n  }\n\n  return this.strip();\n};\n\nBN.prototype.imuln = function imuln(num) {\n  assert(typeof num === 'number');\n\n  // Carry\n  var carry = 0;\n  for (var i = 0; i < this.length; i++) {\n    var w = this.words[i] * num;\n    var lo = (w & 0x3ffffff) + (carry & 0x3ffffff);\n    carry >>= 26;\n    carry += (w / 0x4000000) | 0;\n    // NOTE: lo is 27bit maximum\n    carry += lo >>> 26;\n    this.words[i] = lo & 0x3ffffff;\n  }\n\n  if (carry !== 0) {\n    this.words[i] = carry;\n    this.length++;\n  }\n\n  return this;\n};\n\nBN.prototype.muln = function muln(num) {\n  return this.clone().imuln(num);\n};\n\n// `this` * `this`\nBN.prototype.sqr = function sqr() {\n  return this.mul(this);\n};\n\n// `this` * `this` in-place\nBN.prototype.isqr = function isqr() {\n  return this.mul(this);\n};\n\n// Shift-left in-place\nBN.prototype.ishln = function ishln(bits) {\n  assert(typeof bits === 'number' && bits >= 0);\n  var r = bits % 26;\n  var s = (bits - r) / 26;\n  var carryMask = (0x3ffffff >>> (26 - r)) << (26 - r);\n\n  if (r !== 0) {\n    var carry = 0;\n    for (var i = 0; i < this.length; i++) {\n      var newCarry = this.words[i] & carryMask;\n      var c = (this.words[i] - newCarry) << r;\n      this.words[i] = c | carry;\n      carry = newCarry >>> (26 - r);\n    }\n    if (carry) {\n      this.words[i] = carry;\n      this.length++;\n    }\n  }\n\n  if (s !== 0) {\n    for (var i = this.length - 1; i >= 0; i--)\n      this.words[i + s] = this.words[i];\n    for (var i = 0; i < s; i++)\n      this.words[i] = 0;\n    this.length += s;\n  }\n\n  return this.strip();\n};\n\n// Shift-right in-place\n// NOTE: `hint` is a lowest bit before trailing zeroes\n// NOTE: if `extended` is present - it will be filled with destroyed bits\nBN.prototype.ishrn = function ishrn(bits, hint, extended) {\n  assert(typeof bits === 'number' && bits >= 0);\n  var h;\n  if (hint)\n    h = (hint - (hint % 26)) / 26;\n  else\n    h = 0;\n\n  var r = bits % 26;\n  var s = Math.min((bits - r) / 26, this.length);\n  var mask = 0x3ffffff ^ ((0x3ffffff >>> r) << r);\n  var maskedWords = extended;\n\n  h -= s;\n  h = Math.max(0, h);\n\n  // Extended mode, copy masked part\n  if (maskedWords) {\n    for (var i = 0; i < s; i++)\n      maskedWords.words[i] = this.words[i];\n    maskedWords.length = s;\n  }\n\n  if (s === 0) {\n    // No-op, we should not move anything at all\n  } else if (this.length > s) {\n    this.length -= s;\n    for (var i = 0; i < this.length; i++)\n      this.words[i] = this.words[i + s];\n  } else {\n    this.words[0] = 0;\n    this.length = 1;\n  }\n\n  var carry = 0;\n  for (var i = this.length - 1; i >= 0 && (carry !== 0 || i >= h); i--) {\n    var word = this.words[i];\n    this.words[i] = (carry << (26 - r)) | (word >>> r);\n    carry = word & mask;\n  }\n\n  // Push carried bits as a mask\n  if (maskedWords && carry !== 0)\n    maskedWords.words[maskedWords.length++] = carry;\n\n  if (this.length === 0) {\n    this.words[0] = 0;\n    this.length = 1;\n  }\n\n  this.strip();\n\n  return this;\n};\n\n// Shift-left\nBN.prototype.shln = function shln(bits) {\n  return this.clone().ishln(bits);\n};\n\n// Shift-right\nBN.prototype.shrn = function shrn(bits) {\n  return this.clone().ishrn(bits);\n};\n\n// Test if n bit is set\nBN.prototype.testn = function testn(bit) {\n  assert(typeof bit === 'number' && bit >= 0);\n  var r = bit % 26;\n  var s = (bit - r) / 26;\n  var q = 1 << r;\n\n  // Fast case: bit is much higher than all existing words\n  if (this.length <= s) {\n    return false;\n  }\n\n  // Check bit and return\n  var w = this.words[s];\n\n  return !!(w & q);\n};\n\n// Return only lowers bits of number (in-place)\nBN.prototype.imaskn = function imaskn(bits) {\n  assert(typeof bits === 'number' && bits >= 0);\n  var r = bits % 26;\n  var s = (bits - r) / 26;\n\n  assert(!this.sign, 'imaskn works only with positive numbers');\n\n  if (r !== 0)\n    s++;\n  this.length = Math.min(s, this.length);\n\n  if (r !== 0) {\n    var mask = 0x3ffffff ^ ((0x3ffffff >>> r) << r);\n    this.words[this.length - 1] &= mask;\n  }\n\n  return this.strip();\n};\n\n// Return only lowers bits of number\nBN.prototype.maskn = function maskn(bits) {\n  return this.clone().imaskn(bits);\n};\n\n// Add plain number `num` to `this`\nBN.prototype.iaddn = function iaddn(num) {\n  assert(typeof num === 'number');\n  if (num < 0)\n    return this.isubn(-num);\n\n  // Possible sign change\n  if (this.sign) {\n    if (this.length === 1 && this.words[0] < num) {\n      this.words[0] = num - this.words[0];\n      this.sign = false;\n      return this;\n    }\n\n    this.sign = false;\n    this.isubn(num);\n    this.sign = true;\n    return this;\n  }\n\n  // Add without checks\n  return this._iaddn(num);\n};\n\nBN.prototype._iaddn = function _iaddn(num) {\n  this.words[0] += num;\n\n  // Carry\n  for (var i = 0; i < this.length && this.words[i] >= 0x4000000; i++) {\n    this.words[i] -= 0x4000000;\n    if (i === this.length - 1)\n      this.words[i + 1] = 1;\n    else\n      this.words[i + 1]++;\n  }\n  this.length = Math.max(this.length, i + 1);\n\n  return this;\n};\n\n// Subtract plain number `num` from `this`\nBN.prototype.isubn = function isubn(num) {\n  assert(typeof num === 'number');\n  if (num < 0)\n    return this.iaddn(-num);\n\n  if (this.sign) {\n    this.sign = false;\n    this.iaddn(num);\n    this.sign = true;\n    return this;\n  }\n\n  this.words[0] -= num;\n\n  // Carry\n  for (var i = 0; i < this.length && this.words[i] < 0; i++) {\n    this.words[i] += 0x4000000;\n    this.words[i + 1] -= 1;\n  }\n\n  return this.strip();\n};\n\nBN.prototype.addn = function addn(num) {\n  return this.clone().iaddn(num);\n};\n\nBN.prototype.subn = function subn(num) {\n  return this.clone().isubn(num);\n};\n\nBN.prototype.iabs = function iabs() {\n  this.sign = false;\n\n  return this;\n};\n\nBN.prototype.abs = function abs() {\n  return this.clone().iabs();\n};\n\nBN.prototype._ishlnsubmul = function _ishlnsubmul(num, mul, shift) {\n  // Bigger storage is needed\n  var len = num.length + shift;\n  var i;\n  if (this.words.length < len) {\n    var t = new Array(len);\n    for (var i = 0; i < this.length; i++)\n      t[i] = this.words[i];\n    this.words = t;\n  } else {\n    i = this.length;\n  }\n\n  // Zeroify rest\n  this.length = Math.max(this.length, len);\n  for (; i < this.length; i++)\n    this.words[i] = 0;\n\n  var carry = 0;\n  for (var i = 0; i < num.length; i++) {\n    var w = this.words[i + shift] + carry;\n    var right = num.words[i] * mul;\n    w -= right & 0x3ffffff;\n    carry = (w >> 26) - ((right / 0x4000000) | 0);\n    this.words[i + shift] = w & 0x3ffffff;\n  }\n  for (; i < this.length - shift; i++) {\n    var w = this.words[i + shift] + carry;\n    carry = w >> 26;\n    this.words[i + shift] = w & 0x3ffffff;\n  }\n\n  if (carry === 0)\n    return this.strip();\n\n  // Subtraction overflow\n  assert(carry === -1);\n  carry = 0;\n  for (var i = 0; i < this.length; i++) {\n    var w = -this.words[i] + carry;\n    carry = w >> 26;\n    this.words[i] = w & 0x3ffffff;\n  }\n  this.sign = true;\n\n  return this.strip();\n};\n\nBN.prototype._wordDiv = function _wordDiv(num, mode) {\n  var shift = this.length - num.length;\n\n  var a = this.clone();\n  var b = num;\n\n  // Normalize\n  var bhi = b.words[b.length - 1];\n  var bhiBits = this._countBits(bhi);\n  shift = 26 - bhiBits;\n  if (shift !== 0) {\n    b = b.shln(shift);\n    a.ishln(shift);\n    bhi = b.words[b.length - 1];\n  }\n\n  // Initialize quotient\n  var m = a.length - b.length;\n  var q;\n\n  if (mode !== 'mod') {\n    q = new BN(null);\n    q.length = m + 1;\n    q.words = new Array(q.length);\n    for (var i = 0; i < q.length; i++)\n      q.words[i] = 0;\n  }\n\n  var diff = a.clone()._ishlnsubmul(b, 1, m);\n  if (!diff.sign) {\n    a = diff;\n    if (q)\n      q.words[m] = 1;\n  }\n\n  for (var j = m - 1; j >= 0; j--) {\n    var qj = a.words[b.length + j] * 0x4000000 + a.words[b.length + j - 1];\n\n    // NOTE: (qj / bhi) is (0x3ffffff * 0x4000000 + 0x3ffffff) / 0x2000000 max\n    // (0x7ffffff)\n    qj = Math.min((qj / bhi) | 0, 0x3ffffff);\n\n    a._ishlnsubmul(b, qj, j);\n    while (a.sign) {\n      qj--;\n      a.sign = false;\n      a._ishlnsubmul(b, 1, j);\n      if (a.cmpn(0) !== 0)\n        a.sign = !a.sign;\n    }\n    if (q)\n      q.words[j] = qj;\n  }\n  if (q)\n    q.strip();\n  a.strip();\n\n  // Denormalize\n  if (mode !== 'div' && shift !== 0)\n    a.ishrn(shift);\n  return { div: q ? q : null, mod: a };\n};\n\nBN.prototype.divmod = function divmod(num, mode) {\n  assert(num.cmpn(0) !== 0);\n\n  if (this.sign && !num.sign) {\n    var res = this.neg().divmod(num, mode);\n    var div;\n    var mod;\n    if (mode !== 'mod')\n      div = res.div.neg();\n    if (mode !== 'div')\n      mod = res.mod.cmpn(0) === 0 ? res.mod : num.sub(res.mod);\n    return {\n      div: div,\n      mod: mod\n    };\n  } else if (!this.sign && num.sign) {\n    var res = this.divmod(num.neg(), mode);\n    var div;\n    if (mode !== 'mod')\n      div = res.div.neg();\n    return { div: div, mod: res.mod };\n  } else if (this.sign && num.sign) {\n    return this.neg().divmod(num.neg(), mode);\n  }\n\n  // Both numbers are positive at this point\n\n  // Strip both numbers to approximate shift value\n  if (num.length > this.length || this.cmp(num) < 0)\n    return { div: new BN(0), mod: this };\n\n  // Very short reduction\n  if (num.length === 1) {\n    if (mode === 'div')\n      return { div: this.divn(num.words[0]), mod: null };\n    else if (mode === 'mod')\n      return { div: null, mod: new BN(this.modn(num.words[0])) };\n    return {\n      div: this.divn(num.words[0]),\n      mod: new BN(this.modn(num.words[0]))\n    };\n  }\n\n  return this._wordDiv(num, mode);\n};\n\n// Find `this` / `num`\nBN.prototype.div = function div(num) {\n  return this.divmod(num, 'div').div;\n};\n\n// Find `this` % `num`\nBN.prototype.mod = function mod(num) {\n  return this.divmod(num, 'mod').mod;\n};\n\n// Find Round(`this` / `num`)\nBN.prototype.divRound = function divRound(num) {\n  var dm = this.divmod(num);\n\n  // Fast case - exact division\n  if (dm.mod.cmpn(0) === 0)\n    return dm.div;\n\n  var mod = dm.div.sign ? dm.mod.isub(num) : dm.mod;\n\n  var half = num.shrn(1);\n  var r2 = num.andln(1);\n  var cmp = mod.cmp(half);\n\n  // Round down\n  if (cmp < 0 || r2 === 1 && cmp === 0)\n    return dm.div;\n\n  // Round up\n  return dm.div.sign ? dm.div.isubn(1) : dm.div.iaddn(1);\n};\n\nBN.prototype.modn = function modn(num) {\n  assert(num <= 0x3ffffff);\n  var p = (1 << 26) % num;\n\n  var acc = 0;\n  for (var i = this.length - 1; i >= 0; i--)\n    acc = (p * acc + this.words[i]) % num;\n\n  return acc;\n};\n\n// In-place division by number\nBN.prototype.idivn = function idivn(num) {\n  assert(num <= 0x3ffffff);\n\n  var carry = 0;\n  for (var i = this.length - 1; i >= 0; i--) {\n    var w = this.words[i] + carry * 0x4000000;\n    this.words[i] = (w / num) | 0;\n    carry = w % num;\n  }\n\n  return this.strip();\n};\n\nBN.prototype.divn = function divn(num) {\n  return this.clone().idivn(num);\n};\n\nBN.prototype.egcd = function egcd(p) {\n  assert(!p.sign);\n  assert(p.cmpn(0) !== 0);\n\n  var x = this;\n  var y = p.clone();\n\n  if (x.sign)\n    x = x.mod(p);\n  else\n    x = x.clone();\n\n  // A * x + B * y = x\n  var A = new BN(1);\n  var B = new BN(0);\n\n  // C * x + D * y = y\n  var C = new BN(0);\n  var D = new BN(1);\n\n  var g = 0;\n\n  while (x.isEven() && y.isEven()) {\n    x.ishrn(1);\n    y.ishrn(1);\n    ++g;\n  }\n\n  var yp = y.clone();\n  var xp = x.clone();\n\n  while (x.cmpn(0) !== 0) {\n    while (x.isEven()) {\n      x.ishrn(1);\n      if (A.isEven() && B.isEven()) {\n        A.ishrn(1);\n        B.ishrn(1);\n      } else {\n        A.iadd(yp).ishrn(1);\n        B.isub(xp).ishrn(1);\n      }\n    }\n\n    while (y.isEven()) {\n      y.ishrn(1);\n      if (C.isEven() && D.isEven()) {\n        C.ishrn(1);\n        D.ishrn(1);\n      } else {\n        C.iadd(yp).ishrn(1);\n        D.isub(xp).ishrn(1);\n      }\n    }\n\n    if (x.cmp(y) >= 0) {\n      x.isub(y);\n      A.isub(C);\n      B.isub(D);\n    } else {\n      y.isub(x);\n      C.isub(A);\n      D.isub(B);\n    }\n  }\n\n  return {\n    a: C,\n    b: D,\n    gcd: y.ishln(g)\n  };\n};\n\n// This is reduced incarnation of the binary EEA\n// above, designated to invert members of the\n// _prime_ fields F(p) at a maximal speed\nBN.prototype._invmp = function _invmp(p) {\n  assert(!p.sign);\n  assert(p.cmpn(0) !== 0);\n\n  var a = this;\n  var b = p.clone();\n\n  if (a.sign)\n    a = a.mod(p);\n  else\n    a = a.clone();\n\n  var x1 = new BN(1);\n  var x2 = new BN(0);\n\n  var delta = b.clone();\n\n  while (a.cmpn(1) > 0 && b.cmpn(1) > 0) {\n    while (a.isEven()) {\n      a.ishrn(1);\n      if (x1.isEven())\n        x1.ishrn(1);\n      else\n        x1.iadd(delta).ishrn(1);\n    }\n    while (b.isEven()) {\n      b.ishrn(1);\n      if (x2.isEven())\n        x2.ishrn(1);\n      else\n        x2.iadd(delta).ishrn(1);\n    }\n    if (a.cmp(b) >= 0) {\n      a.isub(b);\n      x1.isub(x2);\n    } else {\n      b.isub(a);\n      x2.isub(x1);\n    }\n  }\n  if (a.cmpn(1) === 0)\n    return x1;\n  else\n    return x2;\n};\n\nBN.prototype.gcd = function gcd(num) {\n  if (this.cmpn(0) === 0)\n    return num.clone();\n  if (num.cmpn(0) === 0)\n    return this.clone();\n\n  var a = this.clone();\n  var b = num.clone();\n  a.sign = false;\n  b.sign = false;\n\n  // Remove common factor of two\n  for (var shift = 0; a.isEven() && b.isEven(); shift++) {\n    a.ishrn(1);\n    b.ishrn(1);\n  }\n\n  do {\n    while (a.isEven())\n      a.ishrn(1);\n    while (b.isEven())\n      b.ishrn(1);\n\n    var r = a.cmp(b);\n    if (r < 0) {\n      // Swap `a` and `b` to make `a` always bigger than `b`\n      var t = a;\n      a = b;\n      b = t;\n    } else if (r === 0 || b.cmpn(1) === 0) {\n      break;\n    }\n\n    a.isub(b);\n  } while (true);\n\n  return b.ishln(shift);\n};\n\n// Invert number in the field F(num)\nBN.prototype.invm = function invm(num) {\n  return this.egcd(num).a.mod(num);\n};\n\nBN.prototype.isEven = function isEven() {\n  return (this.words[0] & 1) === 0;\n};\n\nBN.prototype.isOdd = function isOdd() {\n  return (this.words[0] & 1) === 1;\n};\n\n// And first word and num\nBN.prototype.andln = function andln(num) {\n  return this.words[0] & num;\n};\n\n// Increment at the bit position in-line\nBN.prototype.bincn = function bincn(bit) {\n  assert(typeof bit === 'number');\n  var r = bit % 26;\n  var s = (bit - r) / 26;\n  var q = 1 << r;\n\n  // Fast case: bit is much higher than all existing words\n  if (this.length <= s) {\n    for (var i = this.length; i < s + 1; i++)\n      this.words[i] = 0;\n    this.words[s] |= q;\n    this.length = s + 1;\n    return this;\n  }\n\n  // Add bit and propagate, if needed\n  var carry = q;\n  for (var i = s; carry !== 0 && i < this.length; i++) {\n    var w = this.words[i];\n    w += carry;\n    carry = w >>> 26;\n    w &= 0x3ffffff;\n    this.words[i] = w;\n  }\n  if (carry !== 0) {\n    this.words[i] = carry;\n    this.length++;\n  }\n  return this;\n};\n\nBN.prototype.cmpn = function cmpn(num) {\n  var sign = num < 0;\n  if (sign)\n    num = -num;\n\n  if (this.sign && !sign)\n    return -1;\n  else if (!this.sign && sign)\n    return 1;\n\n  num &= 0x3ffffff;\n  this.strip();\n\n  var res;\n  if (this.length > 1) {\n    res = 1;\n  } else {\n    var w = this.words[0];\n    res = w === num ? 0 : w < num ? -1 : 1;\n  }\n  if (this.sign)\n    res = -res;\n  return res;\n};\n\n// Compare two numbers and return:\n// 1 - if `this` > `num`\n// 0 - if `this` == `num`\n// -1 - if `this` < `num`\nBN.prototype.cmp = function cmp(num) {\n  if (this.sign && !num.sign)\n    return -1;\n  else if (!this.sign && num.sign)\n    return 1;\n\n  var res = this.ucmp(num);\n  if (this.sign)\n    return -res;\n  else\n    return res;\n};\n\n// Unsigned comparison\nBN.prototype.ucmp = function ucmp(num) {\n  // At this point both numbers have the same sign\n  if (this.length > num.length)\n    return 1;\n  else if (this.length < num.length)\n    return -1;\n\n  var res = 0;\n  for (var i = this.length - 1; i >= 0; i--) {\n    var a = this.words[i];\n    var b = num.words[i];\n\n    if (a === b)\n      continue;\n    if (a < b)\n      res = -1;\n    else if (a > b)\n      res = 1;\n    break;\n  }\n  return res;\n};\n\n//\n// A reduce context, could be using montgomery or something better, depending\n// on the `m` itself.\n//\nBN.red = function red(num) {\n  return new Red(num);\n};\n\nBN.prototype.toRed = function toRed(ctx) {\n  assert(!this.red, 'Already a number in reduction context');\n  assert(!this.sign, 'red works only with positives');\n  return ctx.convertTo(this)._forceRed(ctx);\n};\n\nBN.prototype.fromRed = function fromRed() {\n  assert(this.red, 'fromRed works only with numbers in reduction context');\n  return this.red.convertFrom(this);\n};\n\nBN.prototype._forceRed = function _forceRed(ctx) {\n  this.red = ctx;\n  return this;\n};\n\nBN.prototype.forceRed = function forceRed(ctx) {\n  assert(!this.red, 'Already a number in reduction context');\n  return this._forceRed(ctx);\n};\n\nBN.prototype.redAdd = function redAdd(num) {\n  assert(this.red, 'redAdd works only with red numbers');\n  return this.red.add(this, num);\n};\n\nBN.prototype.redIAdd = function redIAdd(num) {\n  assert(this.red, 'redIAdd works only with red numbers');\n  return this.red.iadd(this, num);\n};\n\nBN.prototype.redSub = function redSub(num) {\n  assert(this.red, 'redSub works only with red numbers');\n  return this.red.sub(this, num);\n};\n\nBN.prototype.redISub = function redISub(num) {\n  assert(this.red, 'redISub works only with red numbers');\n  return this.red.isub(this, num);\n};\n\nBN.prototype.redShl = function redShl(num) {\n  assert(this.red, 'redShl works only with red numbers');\n  return this.red.shl(this, num);\n};\n\nBN.prototype.redMul = function redMul(num) {\n  assert(this.red, 'redMul works only with red numbers');\n  this.red._verify2(this, num);\n  return this.red.mul(this, num);\n};\n\nBN.prototype.redIMul = function redIMul(num) {\n  assert(this.red, 'redMul works only with red numbers');\n  this.red._verify2(this, num);\n  return this.red.imul(this, num);\n};\n\nBN.prototype.redSqr = function redSqr() {\n  assert(this.red, 'redSqr works only with red numbers');\n  this.red._verify1(this);\n  return this.red.sqr(this);\n};\n\nBN.prototype.redISqr = function redISqr() {\n  assert(this.red, 'redISqr works only with red numbers');\n  this.red._verify1(this);\n  return this.red.isqr(this);\n};\n\n// Square root over p\nBN.prototype.redSqrt = function redSqrt() {\n  assert(this.red, 'redSqrt works only with red numbers');\n  this.red._verify1(this);\n  return this.red.sqrt(this);\n};\n\nBN.prototype.redInvm = function redInvm() {\n  assert(this.red, 'redInvm works only with red numbers');\n  this.red._verify1(this);\n  return this.red.invm(this);\n};\n\n// Return negative clone of `this` % `red modulo`\nBN.prototype.redNeg = function redNeg() {\n  assert(this.red, 'redNeg works only with red numbers');\n  this.red._verify1(this);\n  return this.red.neg(this);\n};\n\nBN.prototype.redPow = function redPow(num) {\n  assert(this.red && !num.red, 'redPow(normalNum)');\n  this.red._verify1(this);\n  return this.red.pow(this, num);\n};\n\n// Prime numbers with efficient reduction\nvar primes = {\n  k256: null,\n  p224: null,\n  p192: null,\n  p25519: null\n};\n\n// Pseudo-Mersenne prime\nfunction MPrime(name, p) {\n  // P = 2 ^ N - K\n  this.name = name;\n  this.p = new BN(p, 16);\n  this.n = this.p.bitLength();\n  this.k = new BN(1).ishln(this.n).isub(this.p);\n\n  this.tmp = this._tmp();\n}\n\nMPrime.prototype._tmp = function _tmp() {\n  var tmp = new BN(null);\n  tmp.words = new Array(Math.ceil(this.n / 13));\n  return tmp;\n};\n\nMPrime.prototype.ireduce = function ireduce(num) {\n  // Assumes that `num` is less than `P^2`\n  // num = HI * (2 ^ N - K) + HI * K + LO = HI * K + LO (mod P)\n  var r = num;\n  var rlen;\n\n  do {\n    this.split(r, this.tmp);\n    r = this.imulK(r);\n    r = r.iadd(this.tmp);\n    rlen = r.bitLength();\n  } while (rlen > this.n);\n\n  var cmp = rlen < this.n ? -1 : r.ucmp(this.p);\n  if (cmp === 0) {\n    r.words[0] = 0;\n    r.length = 1;\n  } else if (cmp > 0) {\n    r.isub(this.p);\n  } else {\n    r.strip();\n  }\n\n  return r;\n};\n\nMPrime.prototype.split = function split(input, out) {\n  input.ishrn(this.n, 0, out);\n};\n\nMPrime.prototype.imulK = function imulK(num) {\n  return num.imul(this.k);\n};\n\nfunction K256() {\n  MPrime.call(\n    this,\n    'k256',\n    'ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f');\n}\ninherits(K256, MPrime);\n\nK256.prototype.split = function split(input, output) {\n  // 256 = 9 * 26 + 22\n  var mask = 0x3fffff;\n\n  var outLen = Math.min(input.length, 9);\n  for (var i = 0; i < outLen; i++)\n    output.words[i] = input.words[i];\n  output.length = outLen;\n\n  if (input.length <= 9) {\n    input.words[0] = 0;\n    input.length = 1;\n    return;\n  }\n\n  // Shift by 9 limbs\n  var prev = input.words[9];\n  output.words[output.length++] = prev & mask;\n\n  for (var i = 10; i < input.length; i++) {\n    var next = input.words[i];\n    input.words[i - 10] = ((next & mask) << 4) | (prev >>> 22);\n    prev = next;\n  }\n  input.words[i - 10] = prev >>> 22;\n  input.length -= 9;\n};\n\nK256.prototype.imulK = function imulK(num) {\n  // K = 0x1000003d1 = [ 0x40, 0x3d1 ]\n  num.words[num.length] = 0;\n  num.words[num.length + 1] = 0;\n  num.length += 2;\n\n  // bounded at: 0x40 * 0x3ffffff + 0x3d0 = 0x100000390\n  var hi;\n  var lo = 0;\n  for (var i = 0; i < num.length; i++) {\n    var w = num.words[i];\n    hi = w * 0x40;\n    lo += w * 0x3d1;\n    hi += (lo / 0x4000000) | 0;\n    lo &= 0x3ffffff;\n\n    num.words[i] = lo;\n\n    lo = hi;\n  }\n\n  // Fast length reduction\n  if (num.words[num.length - 1] === 0) {\n    num.length--;\n    if (num.words[num.length - 1] === 0)\n      num.length--;\n  }\n  return num;\n};\n\nfunction P224() {\n  MPrime.call(\n    this,\n    'p224',\n    'ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001');\n}\ninherits(P224, MPrime);\n\nfunction P192() {\n  MPrime.call(\n    this,\n    'p192',\n    'ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff');\n}\ninherits(P192, MPrime);\n\nfunction P25519() {\n  // 2 ^ 255 - 19\n  MPrime.call(\n    this,\n    '25519',\n    '7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed');\n}\ninherits(P25519, MPrime);\n\nP25519.prototype.imulK = function imulK(num) {\n  // K = 0x13\n  var carry = 0;\n  for (var i = 0; i < num.length; i++) {\n    var hi = num.words[i] * 0x13 + carry;\n    var lo = hi & 0x3ffffff;\n    hi >>>= 26;\n\n    num.words[i] = lo;\n    carry = hi;\n  }\n  if (carry !== 0)\n    num.words[num.length++] = carry;\n  return num;\n};\n\n// Exported mostly for testing purposes, use plain name instead\nBN._prime = function prime(name) {\n  // Cached version of prime\n  if (primes[name])\n    return primes[name];\n\n  var prime;\n  if (name === 'k256')\n    prime = new K256();\n  else if (name === 'p224')\n    prime = new P224();\n  else if (name === 'p192')\n    prime = new P192();\n  else if (name === 'p25519')\n    prime = new P25519();\n  else\n    throw new Error('Unknown prime ' + name);\n  primes[name] = prime;\n\n  return prime;\n};\n\n//\n// Base reduction engine\n//\nfunction Red(m) {\n  if (typeof m === 'string') {\n    var prime = BN._prime(m);\n    this.m = prime.p;\n    this.prime = prime;\n  } else {\n    this.m = m;\n    this.prime = null;\n  }\n}\n\nRed.prototype._verify1 = function _verify1(a) {\n  assert(!a.sign, 'red works only with positives');\n  assert(a.red, 'red works only with red numbers');\n};\n\nRed.prototype._verify2 = function _verify2(a, b) {\n  assert(!a.sign && !b.sign, 'red works only with positives');\n  assert(a.red && a.red === b.red,\n         'red works only with red numbers');\n};\n\nRed.prototype.imod = function imod(a) {\n  if (this.prime)\n    return this.prime.ireduce(a)._forceRed(this);\n  return a.mod(this.m)._forceRed(this);\n};\n\nRed.prototype.neg = function neg(a) {\n  var r = a.clone();\n  r.sign = !r.sign;\n  return r.iadd(this.m)._forceRed(this);\n};\n\nRed.prototype.add = function add(a, b) {\n  this._verify2(a, b);\n\n  var res = a.add(b);\n  if (res.cmp(this.m) >= 0)\n    res.isub(this.m);\n  return res._forceRed(this);\n};\n\nRed.prototype.iadd = function iadd(a, b) {\n  this._verify2(a, b);\n\n  var res = a.iadd(b);\n  if (res.cmp(this.m) >= 0)\n    res.isub(this.m);\n  return res;\n};\n\nRed.prototype.sub = function sub(a, b) {\n  this._verify2(a, b);\n\n  var res = a.sub(b);\n  if (res.cmpn(0) < 0)\n    res.iadd(this.m);\n  return res._forceRed(this);\n};\n\nRed.prototype.isub = function isub(a, b) {\n  this._verify2(a, b);\n\n  var res = a.isub(b);\n  if (res.cmpn(0) < 0)\n    res.iadd(this.m);\n  return res;\n};\n\nRed.prototype.shl = function shl(a, num) {\n  this._verify1(a);\n  return this.imod(a.shln(num));\n};\n\nRed.prototype.imul = function imul(a, b) {\n  this._verify2(a, b);\n  return this.imod(a.imul(b));\n};\n\nRed.prototype.mul = function mul(a, b) {\n  this._verify2(a, b);\n  return this.imod(a.mul(b));\n};\n\nRed.prototype.isqr = function isqr(a) {\n  return this.imul(a, a);\n};\n\nRed.prototype.sqr = function sqr(a) {\n  return this.mul(a, a);\n};\n\nRed.prototype.sqrt = function sqrt(a) {\n  if (a.cmpn(0) === 0)\n    return a.clone();\n\n  var mod3 = this.m.andln(3);\n  assert(mod3 % 2 === 1);\n\n  // Fast case\n  if (mod3 === 3) {\n    var pow = this.m.add(new BN(1)).ishrn(2);\n    var r = this.pow(a, pow);\n    return r;\n  }\n\n  // Tonelli-Shanks algorithm (Totally unoptimized and slow)\n  //\n  // Find Q and S, that Q * 2 ^ S = (P - 1)\n  var q = this.m.subn(1);\n  var s = 0;\n  while (q.cmpn(0) !== 0 && q.andln(1) === 0) {\n    s++;\n    q.ishrn(1);\n  }\n  assert(q.cmpn(0) !== 0);\n\n  var one = new BN(1).toRed(this);\n  var nOne = one.redNeg();\n\n  // Find quadratic non-residue\n  // NOTE: Max is such because of generalized Riemann hypothesis.\n  var lpow = this.m.subn(1).ishrn(1);\n  var z = this.m.bitLength();\n  z = new BN(2 * z * z).toRed(this);\n  while (this.pow(z, lpow).cmp(nOne) !== 0)\n    z.redIAdd(nOne);\n\n  var c = this.pow(z, q);\n  var r = this.pow(a, q.addn(1).ishrn(1));\n  var t = this.pow(a, q);\n  var m = s;\n  while (t.cmp(one) !== 0) {\n    var tmp = t;\n    for (var i = 0; tmp.cmp(one) !== 0; i++)\n      tmp = tmp.redSqr();\n    assert(i < m);\n    var b = this.pow(c, new BN(1).ishln(m - i - 1));\n\n    r = r.redMul(b);\n    c = b.redSqr();\n    t = t.redMul(c);\n    m = i;\n  }\n\n  return r;\n};\n\nRed.prototype.invm = function invm(a) {\n  var inv = a._invmp(this.m);\n  if (inv.sign) {\n    inv.sign = false;\n    return this.imod(inv).redNeg();\n  } else {\n    return this.imod(inv);\n  }\n};\n\nRed.prototype.pow = function pow(a, num) {\n  var w = [];\n\n  if (num.cmpn(0) === 0)\n    return new BN(1);\n\n  var q = num.clone();\n\n  while (q.cmpn(0) !== 0) {\n    w.push(q.andln(1));\n    q.ishrn(1);\n  }\n\n  // Skip leading zeroes\n  var res = a;\n  for (var i = 0; i < w.length; i++, res = this.sqr(res))\n    if (w[i] !== 0)\n      break;\n\n  if (++i < w.length) {\n    for (var q = this.sqr(res); i < w.length; i++, q = this.sqr(q)) {\n      if (w[i] === 0)\n        continue;\n      res = this.mul(res, q);\n    }\n  }\n\n  return res;\n};\n\nRed.prototype.convertTo = function convertTo(num) {\n  var r = num.mod(this.m);\n  if (r === num)\n    return r.clone();\n  else\n    return r;\n};\n\nRed.prototype.convertFrom = function convertFrom(num) {\n  var res = num.clone();\n  res.red = null;\n  return res;\n};\n\n//\n// Montgomery method engine\n//\n\nBN.mont = function mont(num) {\n  return new Mont(num);\n};\n\nfunction Mont(m) {\n  Red.call(this, m);\n\n  this.shift = this.m.bitLength();\n  if (this.shift % 26 !== 0)\n    this.shift += 26 - (this.shift % 26);\n  this.r = new BN(1).ishln(this.shift);\n  this.r2 = this.imod(this.r.sqr());\n  this.rinv = this.r._invmp(this.m);\n\n  this.minv = this.rinv.mul(this.r).isubn(1).div(this.m);\n  this.minv.sign = true;\n  this.minv = this.minv.mod(this.r);\n}\ninherits(Mont, Red);\n\nMont.prototype.convertTo = function convertTo(num) {\n  return this.imod(num.shln(this.shift));\n};\n\nMont.prototype.convertFrom = function convertFrom(num) {\n  var r = this.imod(num.mul(this.rinv));\n  r.red = null;\n  return r;\n};\n\nMont.prototype.imul = function imul(a, b) {\n  if (a.cmpn(0) === 0 || b.cmpn(0) === 0) {\n    a.words[0] = 0;\n    a.length = 1;\n    return a;\n  }\n\n  var t = a.imul(b);\n  var c = t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);\n  var u = t.isub(c).ishrn(this.shift);\n  var res = u;\n  if (u.cmp(this.m) >= 0)\n    res = u.isub(this.m);\n  else if (u.cmpn(0) < 0)\n    res = u.iadd(this.m);\n\n  return res._forceRed(this);\n};\n\nMont.prototype.mul = function mul(a, b) {\n  if (a.cmpn(0) === 0 || b.cmpn(0) === 0)\n    return new BN(0)._forceRed(this);\n\n  var t = a.mul(b);\n  var c = t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);\n  var u = t.isub(c).ishrn(this.shift);\n  var res = u;\n  if (u.cmp(this.m) >= 0)\n    res = u.isub(this.m);\n  else if (u.cmpn(0) < 0)\n    res = u.iadd(this.m);\n\n  return res._forceRed(this);\n};\n\nMont.prototype.invm = function invm(a) {\n  // (AR)^-1 * R^2 = (A^-1 * R^-1) * R^2 = A^-1 * R\n  var res = this.imod(a._invmp(this.m).mul(this.r2));\n  return res._forceRed(this);\n};\n\n})(typeof module === 'undefined' || module, this);\n"]},"metadata":{},"sourceType":"script"}