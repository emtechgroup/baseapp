{"ast":null,"code":"import _classCallCheck from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/anthonypafundi/Desktop/baseapp/src/containers/Confirm/Documents/index.tsx\";\nimport cr from 'classnames';\nimport * as countries from 'i18n-iso-countries';\nimport * as React from 'react';\nimport { Button } from 'react-bootstrap';\nimport { injectIntl } from 'react-intl';\nimport MaskInput from 'react-maskinput';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { compose } from 'redux';\nimport { languages } from '../../../api/config';\nimport { CustomInput, DropdownComponent, UploadFile } from '../../../components';\nimport { formatDate, isDateInFuture, randomSecureHex } from '../../../helpers';\nimport { alertPush, selectCurrentLanguage, selectMobileDeviceState, selectSendDocumentsSuccess, sendDocuments as _sendDocuments } from '../../../modules';\n\nvar DocumentFrontExample = require('../../../assets/images/kyc/DocumentFrontExample.svg');\n\nvar DocumentBackExample = require('../../../assets/images/kyc/DocumentBackExample.svg');\n\nvar DocumentSelfieExample = require('../../../assets/images/kyc/DocumentSelfieExample.svg');\n\n// tslint:disable:member-ordering\nvar DocumentsComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(DocumentsComponent, _React$Component);\n\n  var _super = _createSuper(DocumentsComponent);\n\n  function DocumentsComponent() {\n    var _this;\n\n    _classCallCheck(this, DocumentsComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.translate = function (e) {\n      return _this.props.intl.formatMessage({\n        id: e\n      });\n    };\n\n    _this.data = [_this.translate('page.body.kyc.documents.select.passport'), _this.translate('page.body.kyc.documents.select.identityCard'), _this.translate('page.body.kyc.documents.select.driverLicense')];\n    _this.state = {\n      documentsType: '',\n      issuedDate: '',\n      issuedDateFocused: false,\n      expireDate: '',\n      expireDateFocused: false,\n      idNumber: '',\n      idNumberFocused: false,\n      fileFront: [],\n      fileBack: [],\n      fileSelfie: []\n    };\n\n    _this.handleChangeDocumentsType = function (value) {\n      _this.setState({\n        documentsType: value\n      });\n    };\n\n    _this.handleChangeIdNumber = function (value) {\n      _this.setState({\n        idNumber: value\n      });\n    };\n\n    _this.handleFieldFocus = function (field) {\n      return function () {\n        switch (field) {\n          case 'issuedDate':\n            _this.setState({\n              issuedDateFocused: !_this.state.issuedDateFocused\n            });\n\n            break;\n\n          case 'expireDate':\n            _this.setState({\n              expireDateFocused: !_this.state.expireDateFocused\n            });\n\n            break;\n\n          case 'idNumber':\n            _this.setState({\n              idNumberFocused: !_this.state.idNumberFocused\n            });\n\n            break;\n\n          default:\n            break;\n        }\n      };\n    };\n\n    _this.handleChangeIssuedDate = function (e) {\n      _this.setState({\n        issuedDate: formatDate(e.target.value)\n      });\n    };\n\n    _this.handleChangeExpiration = function (e) {\n      _this.setState({\n        expireDate: formatDate(e.target.value)\n      });\n    };\n\n    _this.handleUploadScan = function (uploadEvent, id) {\n      var allFiles = uploadEvent.target.files;\n      var maxDocsCount = 1;\n      var additionalFileList = Array.from(allFiles).length > maxDocsCount ? Array.from(allFiles).slice(0, maxDocsCount) : Array.from(allFiles);\n\n      switch (id) {\n        case 'front':\n          _this.setState({\n            fileFront: additionalFileList\n          });\n\n          break;\n\n        case 'back':\n          _this.setState({\n            fileBack: additionalFileList\n          });\n\n          break;\n\n        case 'selfie':\n          _this.setState({\n            fileSelfie: additionalFileList\n          });\n\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    _this.handleValidateInput = function (field, value) {\n      switch (field) {\n        case 'issuedDate':\n          return !isDateInFuture(value);\n\n        case 'expireDate':\n          return isDateInFuture(value);\n\n        case 'idNumber':\n          var cityRegex = new RegExp(\"^[a-zA-Z0-9]+$\");\n          return value.match(cityRegex) ? true : false;\n\n        default:\n          return true;\n      }\n    };\n\n    _this.handleCheckButtonDisabled = function () {\n      var _this$state = _this.state,\n          documentsType = _this$state.documentsType,\n          issuedDate = _this$state.issuedDate,\n          expireDate = _this$state.expireDate,\n          fileBack = _this$state.fileBack,\n          fileFront = _this$state.fileFront,\n          fileSelfie = _this$state.fileSelfie,\n          idNumber = _this$state.idNumber;\n\n      var typeOfDocuments = _this.getDocumentsType(documentsType);\n\n      var filesValid = typeOfDocuments === 'Passport' ? fileFront.length && fileSelfie.length : fileSelfie.length && fileFront.length && fileBack.length;\n      return !_this.handleValidateInput('idNumber', idNumber) || !_this.handleValidateInput('issuedDate', issuedDate) || expireDate && !_this.handleValidateInput('expireDate', expireDate) || !filesValid;\n    };\n\n    _this.sendDocuments = function () {\n      var _this$state2 = _this.state,\n          documentsType = _this$state2.documentsType,\n          fileBack = _this$state2.fileBack,\n          fileFront = _this$state2.fileFront,\n          fileSelfie = _this$state2.fileSelfie;\n      var identificator = randomSecureHex(32);\n\n      if (_this.handleCheckButtonDisabled()) {\n        return;\n      }\n\n      _this.props.sendDocuments(_this.createFormData('front_side', fileFront, identificator));\n\n      if (documentsType !== 'Passport') {\n        _this.props.sendDocuments(_this.createFormData('back_side', fileBack, identificator));\n      }\n\n      _this.props.sendDocuments(_this.createFormData('selfie', fileSelfie, identificator));\n    };\n\n    _this.createFormData = function (docCategory, upload, identificator) {\n      var _this$state3 = _this.state,\n          documentsType = _this$state3.documentsType,\n          expireDate = _this$state3.expireDate,\n          issuedDate = _this$state3.issuedDate,\n          idNumber = _this$state3.idNumber;\n\n      var typeOfDocuments = _this.getDocumentsType(documentsType);\n\n      var request = new FormData();\n\n      if (expireDate) {\n        request.append('doc_expire', expireDate);\n      }\n\n      request.append('doc_issue', issuedDate);\n      request.append('doc_type', typeOfDocuments);\n      request.append('doc_number', idNumber);\n      request.append('identificator', identificator);\n      request.append('doc_category', docCategory);\n      request.append('upload[]', upload[0]);\n      return request;\n    };\n\n    _this.getDocumentsType = function (value) {\n      switch (value) {\n        case _this.data[0]:\n          return 'Passport';\n\n        case _this.data[1]:\n          return 'Identity card';\n\n        case _this.data[2]:\n          return 'Driver license';\n\n        default:\n          return value;\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(DocumentsComponent, [{\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(next) {\n      if (next.success && !this.props.success) {\n        this.props.history.push('/profile');\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var isMobileDevice = this.props.isMobileDevice;\n      var _this$state4 = this.state,\n          fileFront = _this$state4.fileFront,\n          fileBack = _this$state4.fileBack,\n          fileSelfie = _this$state4.fileSelfie,\n          issuedDate = _this$state4.issuedDate,\n          issuedDateFocused = _this$state4.issuedDateFocused,\n          expireDate = _this$state4.expireDate,\n          expireDateFocused = _this$state4.expireDateFocused,\n          idNumber = _this$state4.idNumber,\n          idNumberFocused = _this$state4.idNumberFocused;\n      /* tslint:disable */\n\n      languages.map(function (l) {\n        return countries.registerLocale(require(\"i18n-iso-countries/langs/\".concat(l, \".json\")));\n      });\n      /* tslint:enable */\n\n      var issuedDateFocusedClass = cr('pg-confirm__content-documents__row__content', {\n        'pg-confirm__content-documents__row__content--focused': issuedDateFocused,\n        'pg-confirm__content-documents__row__content--wrong': issuedDate && !this.handleValidateInput('issuedDate', issuedDate)\n      });\n      var expireDateFocusedClass = cr('pg-confirm__content-documents__row__content', {\n        'pg-confirm__content-documents__row__content--focused': expireDateFocused,\n        'pg-confirm__content-documents__row__content--wrong': expireDate && !this.handleValidateInput('expireDate', expireDate)\n      });\n      var idNumberFocusedClass = cr('pg-confirm__content-documents__row__content', {\n        'pg-confirm__content-documents__row__content--focused': idNumberFocused,\n        'pg-confirm__content-documents__row__content--wrong': idNumber && !this.handleValidateInput('idNumber', idNumber)\n      });\n\n      var onSelect = function onSelect(value) {\n        return _this2.handleChangeDocumentsType(_this2.data[value]);\n      };\n\n      return /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-confirm__content-documents\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-confirm__content-documents__row__content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-confirm__content-documents__row__content-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 25\n        }\n      }, this.translate('page.body.kyc.documentsType')), /*#__PURE__*/React.createElement(DropdownComponent, {\n        className: \"pg-confirm__content-documents__row__content-number-dropdown\",\n        list: this.data,\n        onSelect: onSelect,\n        placeholder: this.translate('page.body.kyc.documentsType.placeholder'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-confirm__content-documents__row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: idNumberFocusedClass,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(CustomInput, {\n        type: \"string\",\n        label: this.translate('page.body.kyc.documents.idNumber'),\n        labelVisible: true,\n        defaultLabel: '',\n        placeholder: this.translate('page.body.kyc.documents.idNumber.placeholder'),\n        inputValue: idNumber,\n        handleChangeInput: this.handleChangeIdNumber,\n        handleFocusInput: this.handleFieldFocus('idNumber'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-confirm__content-documents__row input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: issuedDateFocusedClass,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-input\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 33\n        }\n      }, this.translate('page.body.kyc.documents.issuedDate')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-lg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(MaskInput, {\n        maskString: \"00/00/0000\",\n        mask: \"00/00/0000\",\n        onChange: this.handleChangeIssuedDate,\n        onFocus: this.handleFieldFocus('issuedDate'),\n        onBlur: this.handleFieldFocus('issuedDate'),\n        value: issuedDate,\n        className: \"group-input\",\n        placeholder: this.translate('page.body.kyc.documents.issuedDate.placeholder'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 37\n        }\n      })))), /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: expireDateFocusedClass,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-input\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 33\n        }\n      }, this.translate('page.body.kyc.documents.expiryDate')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-lg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(MaskInput, {\n        maskString: \"00/00/0000\",\n        mask: \"00/00/0000\",\n        onChange: this.handleChangeExpiration,\n        onFocus: this.handleFieldFocus('expireDate'),\n        onBlur: this.handleFieldFocus('expireDate'),\n        value: expireDate,\n        className: \"group-input\",\n        placeholder: this.translate('page.body.kyc.documents.expiryDate.placeholder'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 37\n        }\n      }))))), this.state.documentsType ? /*#__PURE__*/React.createElement(UploadFile, {\n        isMobileDevice: isMobileDevice,\n        id: \"fileFront\",\n        title: this.translate('page.body.kyc.documents.uploadFile.front.title'),\n        label: this.translate('page.body.kyc.documents.uploadFile.front.label'),\n        buttonText: this.translate('page.body.kyc.documents.uploadFile.front.button'),\n        sizesText: this.translate('page.body.kyc.documents.uploadFile.front.sizes'),\n        formatsText: this.translate('page.body.kyc.documents.uploadFile.front.formats'),\n        handleUploadScan: function handleUploadScan(uploadEvent) {\n          return _this2.handleUploadScan(uploadEvent, 'front');\n        },\n        exampleImagePath: DocumentFrontExample,\n        uploadedFile: fileFront[0] && fileFront[0].name,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 25\n        }\n      }) : null, this.state.documentsType && this.state.documentsType !== 'Passport' ? /*#__PURE__*/React.createElement(UploadFile, {\n        isMobileDevice: isMobileDevice,\n        id: \"fileBack\",\n        title: this.translate('page.body.kyc.documents.uploadFile.back.title'),\n        label: this.translate('page.body.kyc.documents.uploadFile.back.label'),\n        buttonText: this.translate('page.body.kyc.documents.uploadFile.back.button'),\n        sizesText: this.translate('page.body.kyc.documents.uploadFile.back.sizes'),\n        formatsText: this.translate('page.body.kyc.documents.uploadFile.back.formats'),\n        handleUploadScan: function handleUploadScan(uploadEvent) {\n          return _this2.handleUploadScan(uploadEvent, 'back');\n        },\n        exampleImagePath: DocumentBackExample,\n        uploadedFile: fileBack[0] && fileBack[0].name,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 25\n        }\n      }) : null, this.state.documentsType ? /*#__PURE__*/React.createElement(UploadFile, {\n        isMobileDevice: isMobileDevice,\n        id: \"fileSelfie\",\n        title: this.translate('page.body.kyc.documents.uploadFile.selfie.title'),\n        label: this.translate('page.body.kyc.documents.uploadFile.selfie.label'),\n        buttonText: this.translate('page.body.kyc.documents.uploadFile.selfie.button'),\n        sizesText: this.translate('page.body.kyc.documents.uploadFile.selfie.sizes'),\n        formatsText: this.translate('page.body.kyc.documents.uploadFile.selfie.formats'),\n        handleUploadScan: function handleUploadScan(uploadEvent) {\n          return _this2.handleUploadScan(uploadEvent, 'selfie');\n        },\n        exampleImagePath: DocumentSelfieExample,\n        uploadedFile: fileSelfie[0] && fileSelfie[0].name,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 25\n        }\n      }) : null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-confirm__content-deep\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        onClick: this.sendDocuments,\n        disabled: this.handleCheckButtonDisabled(),\n        size: \"lg\",\n        variant: \"primary\",\n        type: \"button\",\n        block: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 25\n        }\n      }, this.translate('page.body.kyc.submit')))));\n    }\n  }]);\n\n  return DocumentsComponent;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    lang: selectCurrentLanguage(state),\n    success: selectSendDocumentsSuccess(state),\n    isMobileDevice: selectMobileDeviceState(state)\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    fetchAlert: function fetchAlert(payload) {\n      return dispatch(alertPush(payload));\n    },\n    sendDocuments: function sendDocuments(payload) {\n      return dispatch(_sendDocuments(payload));\n    }\n  };\n};\n\nexport var Documents = compose(injectIntl, withRouter, connect(mapStateToProps, mapDispatchToProps))(DocumentsComponent); // tslint:disable-line","map":{"version":3,"sources":["/Users/anthonypafundi/Desktop/baseapp/src/containers/Confirm/Documents/index.tsx"],"names":["cr","countries","React","Button","injectIntl","MaskInput","connect","withRouter","compose","languages","CustomInput","DropdownComponent","UploadFile","formatDate","isDateInFuture","randomSecureHex","alertPush","selectCurrentLanguage","selectMobileDeviceState","selectSendDocumentsSuccess","sendDocuments","DocumentFrontExample","require","DocumentBackExample","DocumentSelfieExample","DocumentsComponent","translate","e","props","intl","formatMessage","id","data","state","documentsType","issuedDate","issuedDateFocused","expireDate","expireDateFocused","idNumber","idNumberFocused","fileFront","fileBack","fileSelfie","handleChangeDocumentsType","value","setState","handleChangeIdNumber","handleFieldFocus","field","handleChangeIssuedDate","target","handleChangeExpiration","handleUploadScan","uploadEvent","allFiles","files","maxDocsCount","additionalFileList","Array","from","length","slice","handleValidateInput","cityRegex","RegExp","match","handleCheckButtonDisabled","typeOfDocuments","getDocumentsType","filesValid","identificator","createFormData","docCategory","upload","request","FormData","append","next","success","history","push","isMobileDevice","map","l","registerLocale","issuedDateFocusedClass","expireDateFocusedClass","idNumberFocusedClass","onSelect","name","Component","mapStateToProps","lang","mapDispatchToProps","dispatch","fetchAlert","payload","Documents"],"mappings":"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","sourcesContent":["import cr from 'classnames';\nimport * as countries from 'i18n-iso-countries';\nimport * as React from 'react';\nimport { Button } from 'react-bootstrap';\nimport { injectIntl } from 'react-intl';\nimport MaskInput from 'react-maskinput';\nimport { connect, MapDispatchToPropsFunction } from 'react-redux';\nimport { RouterProps } from 'react-router';\nimport { withRouter } from 'react-router-dom';\nimport { compose } from 'redux';\nimport { IntlProps } from '../../../';\nimport { languages } from '../../../api/config';\nimport { CustomInput, DropdownComponent, UploadFile } from '../../../components';\nimport { formatDate, isDateInFuture, randomSecureHex } from '../../../helpers';\nimport {\n    alertPush,\n    RootState,\n    selectCurrentLanguage,\n    selectMobileDeviceState,\n    selectSendDocumentsSuccess,\n    sendDocuments,\n} from '../../../modules';\n\nconst DocumentFrontExample = require('../../../assets/images/kyc/DocumentFrontExample.svg');\nconst DocumentBackExample = require('../../../assets/images/kyc/DocumentBackExample.svg');\nconst DocumentSelfieExample = require('../../../assets/images/kyc/DocumentSelfieExample.svg');\n\ninterface ReduxProps {\n    lang: string;\n    success?: string;\n    isMobileDevice: boolean;\n}\n\ninterface DispatchProps {\n    sendDocuments: typeof sendDocuments;\n    fetchAlert: typeof alertPush;\n}\n\ninterface OnChangeEvent {\n    target: {\n        value: string;\n    };\n}\n\ninterface DocumentsState {\n    documentsType: string;\n    issuedDate: string;\n    issuedDateFocused: boolean;\n    expireDate: string;\n    expireDateFocused: boolean;\n    idNumber: string;\n    idNumberFocused: boolean;\n    fileFront: File[];\n    fileBack: File[];\n    fileSelfie: File[];\n}\n\ntype Props = ReduxProps & DispatchProps & RouterProps & IntlProps;\n\n// tslint:disable:member-ordering\nclass DocumentsComponent extends React.Component<Props, DocumentsState> {\n    public translate = (e: string) => {\n        return this.props.intl.formatMessage({id: e});\n    };\n\n    public data = [\n        this.translate('page.body.kyc.documents.select.passport'),\n        this.translate('page.body.kyc.documents.select.identityCard'),\n        this.translate('page.body.kyc.documents.select.driverLicense'),\n    ];\n\n    public state = {\n        documentsType: '',\n        issuedDate: '',\n        issuedDateFocused: false,\n        expireDate: '',\n        expireDateFocused: false,\n        idNumber: '',\n        idNumberFocused: false,\n        fileFront: [],\n        fileBack: [],\n        fileSelfie: [],\n    };\n\n    public UNSAFE_componentWillReceiveProps(next: Props) {\n        if (next.success && !this.props.success) {\n            this.props.history.push('/profile');\n        }\n    }\n\n    public render() {\n        const { isMobileDevice } = this.props;\n        const {\n            fileFront,\n            fileBack,\n            fileSelfie,\n            issuedDate,\n            issuedDateFocused,\n            expireDate,\n            expireDateFocused,\n            idNumber,\n            idNumberFocused,\n        }: DocumentsState = this.state;\n\n        /* tslint:disable */\n        languages.map((l: string) => countries.registerLocale(require(`i18n-iso-countries/langs/${l}.json`)));\n        /* tslint:enable */\n\n        const issuedDateFocusedClass = cr('pg-confirm__content-documents__row__content', {\n            'pg-confirm__content-documents__row__content--focused': issuedDateFocused,\n            'pg-confirm__content-documents__row__content--wrong': issuedDate && !this.handleValidateInput('issuedDate', issuedDate),\n        });\n\n        const expireDateFocusedClass = cr('pg-confirm__content-documents__row__content', {\n            'pg-confirm__content-documents__row__content--focused': expireDateFocused,\n            'pg-confirm__content-documents__row__content--wrong': expireDate && !this.handleValidateInput('expireDate', expireDate),\n        });\n\n        const idNumberFocusedClass = cr('pg-confirm__content-documents__row__content', {\n            'pg-confirm__content-documents__row__content--focused': idNumberFocused,\n            'pg-confirm__content-documents__row__content--wrong': idNumber && !this.handleValidateInput('idNumber', idNumber),\n        });\n\n        const onSelect = value => this.handleChangeDocumentsType(this.data[value]);\n\n        return (\n            <React.Fragment>\n                <div className=\"pg-confirm__content-documents\">\n                    <div className=\"pg-confirm__content-documents__row__content\">\n                        <div className=\"pg-confirm__content-documents__row__content-label\">\n                            {this.translate('page.body.kyc.documentsType')}\n                        </div>\n                        <DropdownComponent\n                            className=\"pg-confirm__content-documents__row__content-number-dropdown\"\n                            list={this.data}\n                            onSelect={onSelect}\n                            placeholder={this.translate('page.body.kyc.documentsType.placeholder')}\n                        />\n                    </div>\n                    <div className=\"pg-confirm__content-documents__row\">\n                        <fieldset className={idNumberFocusedClass}>\n                            <CustomInput\n                                type=\"string\"\n                                label={this.translate('page.body.kyc.documents.idNumber')}\n                                labelVisible={true}\n                                defaultLabel={''}\n                                placeholder={this.translate('page.body.kyc.documents.idNumber.placeholder')}\n                                inputValue={idNumber}\n                                handleChangeInput={this.handleChangeIdNumber}\n                                handleFocusInput={this.handleFieldFocus('idNumber')}\n                            />\n                        </fieldset>\n                    </div>\n                    <div className=\"pg-confirm__content-documents__row input-group\">\n                        <fieldset className={issuedDateFocusedClass}>\n                            <div className=\"custom-input\">\n                                <label>{this.translate('page.body.kyc.documents.issuedDate')}</label>\n                                <div className=\"input-group input-group-lg\">\n                                    <MaskInput\n                                        maskString=\"00/00/0000\"\n                                        mask=\"00/00/0000\"\n                                        onChange={this.handleChangeIssuedDate}\n                                        onFocus={this.handleFieldFocus('issuedDate')}\n                                        onBlur={this.handleFieldFocus('issuedDate')}\n                                        value={issuedDate}\n                                        className=\"group-input\"\n                                        placeholder={this.translate('page.body.kyc.documents.issuedDate.placeholder')}\n                                    />\n                                </div>\n                            </div>\n                        </fieldset>\n                        <fieldset className={expireDateFocusedClass}>\n                            <div className=\"custom-input\">\n                                <label>{this.translate('page.body.kyc.documents.expiryDate')}</label>\n                                <div className=\"input-group input-group-lg\">\n                                    <MaskInput\n                                        maskString=\"00/00/0000\"\n                                        mask=\"00/00/0000\"\n                                        onChange={this.handleChangeExpiration}\n                                        onFocus={this.handleFieldFocus('expireDate')}\n                                        onBlur={this.handleFieldFocus('expireDate')}\n                                        value={expireDate}\n                                        className=\"group-input\"\n                                        placeholder={this.translate('page.body.kyc.documents.expiryDate.placeholder')}\n                                    />\n                                </div>\n                            </div>\n                        </fieldset>\n                    </div>\n                    {this.state.documentsType  ? (\n                        <UploadFile\n                            isMobileDevice={isMobileDevice}\n                            id=\"fileFront\"\n                            title={this.translate('page.body.kyc.documents.uploadFile.front.title')}\n                            label={this.translate('page.body.kyc.documents.uploadFile.front.label')}\n                            buttonText={this.translate('page.body.kyc.documents.uploadFile.front.button')}\n                            sizesText={this.translate('page.body.kyc.documents.uploadFile.front.sizes')}\n                            formatsText={this.translate('page.body.kyc.documents.uploadFile.front.formats')}\n                            handleUploadScan={uploadEvent => this.handleUploadScan(uploadEvent, 'front')}\n                            exampleImagePath={DocumentFrontExample}\n                            uploadedFile={fileFront[0] && (fileFront[0] as File).name}\n                        />\n                    ) : null}\n                    {this.state.documentsType && this.state.documentsType !== 'Passport' ? (\n                        <UploadFile\n                            isMobileDevice={isMobileDevice}\n                            id=\"fileBack\"\n                            title={this.translate('page.body.kyc.documents.uploadFile.back.title')}\n                            label={this.translate('page.body.kyc.documents.uploadFile.back.label')}\n                            buttonText={this.translate('page.body.kyc.documents.uploadFile.back.button')}\n                            sizesText={this.translate('page.body.kyc.documents.uploadFile.back.sizes')}\n                            formatsText={this.translate('page.body.kyc.documents.uploadFile.back.formats')}\n                            handleUploadScan={uploadEvent => this.handleUploadScan(uploadEvent, 'back')}\n                            exampleImagePath={DocumentBackExample}\n                            uploadedFile={fileBack[0] && (fileBack[0] as File).name}\n                        />\n                    ) : null}\n                    {this.state.documentsType  ? (\n                        <UploadFile\n                            isMobileDevice={isMobileDevice}\n                            id=\"fileSelfie\"\n                            title={this.translate('page.body.kyc.documents.uploadFile.selfie.title')}\n                            label={this.translate('page.body.kyc.documents.uploadFile.selfie.label')}\n                            buttonText={this.translate('page.body.kyc.documents.uploadFile.selfie.button')}\n                            sizesText={this.translate('page.body.kyc.documents.uploadFile.selfie.sizes')}\n                            formatsText={this.translate('page.body.kyc.documents.uploadFile.selfie.formats')}\n                            handleUploadScan={uploadEvent => this.handleUploadScan(uploadEvent, 'selfie')}\n                            exampleImagePath={DocumentSelfieExample}\n                            uploadedFile={fileSelfie[0] && (fileSelfie[0] as File).name}\n                        />\n                    ) : null}\n                    <div className=\"pg-confirm__content-deep\">\n                        <Button\n                            onClick={this.sendDocuments}\n                            disabled={this.handleCheckButtonDisabled()}\n                            size=\"lg\"\n                            variant=\"primary\"\n                            type=\"button\"\n                            block={true}\n                        >\n                            {this.translate('page.body.kyc.submit')}\n                        </Button>\n                    </div>\n                </div>\n            </React.Fragment>\n        );\n    }\n\n    private handleChangeDocumentsType = (value: string) => {\n        this.setState({\n            documentsType: value,\n        });\n    };\n\n    private handleChangeIdNumber = (value: string) => {\n        this.setState({\n            idNumber: value,\n        });\n    };\n\n    private handleFieldFocus = (field: string) => {\n        return () => {\n            switch (field) {\n                case 'issuedDate':\n                    this.setState({\n                        issuedDateFocused: !this.state.issuedDateFocused,\n                    });\n                    break;\n                case 'expireDate':\n                    this.setState({\n                        expireDateFocused: !this.state.expireDateFocused,\n                    });\n                    break;\n                case 'idNumber':\n                    this.setState({\n                        idNumberFocused: !this.state.idNumberFocused,\n                    });\n                    break;\n                default:\n                    break;\n            }\n        };\n    };\n\n    private handleChangeIssuedDate = (e: OnChangeEvent) => {\n        this.setState({\n            issuedDate: formatDate(e.target.value),\n        });\n    };\n\n    private handleChangeExpiration = (e: OnChangeEvent) => {\n        this.setState({\n            expireDate: formatDate(e.target.value),\n        });\n    };\n\n    private handleUploadScan = (uploadEvent, id) => {\n        const allFiles: File[] = uploadEvent.target.files;\n        const maxDocsCount = 1;\n        const additionalFileList = Array.from(allFiles).length > maxDocsCount ?  Array.from(allFiles).slice(0, maxDocsCount) : Array.from(allFiles);\n\n        switch (id) {\n            case 'front':\n                this.setState({ fileFront: additionalFileList });\n                break;\n            case 'back':\n                this.setState({ fileBack: additionalFileList});\n                break;\n            case 'selfie':\n                this.setState({ fileSelfie: additionalFileList });\n                break;\n            default:\n                break;\n        }\n    };\n\n    private handleValidateInput = (field: string, value: string): boolean => {\n        switch (field) {\n            case 'issuedDate':\n                return !isDateInFuture(value);\n            case 'expireDate':\n                return isDateInFuture(value);\n            case 'idNumber':\n                const cityRegex = new RegExp(`^[a-zA-Z0-9]+$`);\n\n                return value.match(cityRegex) ? true : false;\n            default:\n                return true;\n        }\n    };\n\n    private handleCheckButtonDisabled = () => {\n        const {\n            documentsType,\n            issuedDate,\n            expireDate,\n            fileBack,\n            fileFront,\n            fileSelfie,\n            idNumber,\n        } = this.state;\n\n        const typeOfDocuments = this.getDocumentsType(documentsType);\n        const filesValid = (typeOfDocuments === 'Passport') ? (\n            fileFront.length &&\n            fileSelfie.length\n        ) : (\n            fileSelfie.length &&\n            fileFront.length &&\n            fileBack.length\n        );\n\n        return (\n            !this.handleValidateInput('idNumber', idNumber) ||\n            !this.handleValidateInput('issuedDate', issuedDate) ||\n            (expireDate && !this.handleValidateInput('expireDate', expireDate)) ||\n            !filesValid\n        );\n    };\n\n    private sendDocuments = () => {\n        const {\n            documentsType,\n            fileBack,\n            fileFront,\n            fileSelfie,\n        } = this.state;\n        const identificator = randomSecureHex(32);\n\n        if (this.handleCheckButtonDisabled()) {\n            return;\n        }\n\n        this.props.sendDocuments(this.createFormData('front_side', fileFront, identificator));\n\n        if (documentsType !== 'Passport') {\n            this.props.sendDocuments(this.createFormData('back_side', fileBack, identificator));\n        }\n\n        this.props.sendDocuments(this.createFormData('selfie', fileSelfie, identificator));\n    };\n\n    private createFormData = (docCategory: string, upload: File[], identificator: string) => {\n        const {\n            documentsType,\n            expireDate,\n            issuedDate,\n            idNumber,\n        }: DocumentsState = this.state;\n        const typeOfDocuments = this.getDocumentsType(documentsType);\n\n        const request = new FormData();\n\n        if (expireDate) {\n            request.append('doc_expire', expireDate);\n        }\n\n        request.append('doc_issue', issuedDate);\n        request.append('doc_type', typeOfDocuments);\n        request.append('doc_number', idNumber);\n        request.append('identificator', identificator);\n        request.append('doc_category', docCategory);\n        request.append('upload[]', upload[0]);\n\n        return request;\n    };\n\n    private getDocumentsType = (value: string) => {\n        switch (value) {\n           case this.data[0]: return 'Passport';\n           case this.data[1]: return 'Identity card';\n           case this.data[2]: return 'Driver license';\n           default: return value;\n        }\n    };\n}\n\nconst mapStateToProps = (state: RootState): ReduxProps => ({\n    lang: selectCurrentLanguage(state),\n    success: selectSendDocumentsSuccess(state),\n    isMobileDevice: selectMobileDeviceState(state),\n});\n\nconst mapDispatchToProps: MapDispatchToPropsFunction<DispatchProps, {}> =\n    dispatch => ({\n        fetchAlert: payload => dispatch(alertPush(payload)),\n        sendDocuments: payload => dispatch(sendDocuments(payload)),\n    });\n\nexport const Documents = compose(\n    injectIntl,\n    withRouter,\n    connect(mapStateToProps, mapDispatchToProps),\n)(DocumentsComponent) as any; // tslint:disable-line\n"]},"metadata":{},"sourceType":"module"}