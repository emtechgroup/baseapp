{"ast":null,"code":"import _slicedToArray from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/anthonypafundi/Desktop/baseapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/anthonypafundi/Desktop/baseapp/src/containers/ToolBar/MarketSelector/MarketsList/index.tsx\";\n\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport { injectIntl } from 'react-intl';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { incrementalOrderBook } from '../../../../api';\nimport { SortAsc, SortDefault, SortDesc } from '../../../../assets/images/SortIcons';\nimport { Decimal, Table } from '../../../../components';\nimport { depthFetch, selectCurrentMarket, selectMarkets, selectMarketTickers, setCurrentMarket, setCurrentPrice } from '../../../../modules';\n\nvar handleChangeSortIcon = function handleChangeSortIcon(sortBy, id, reverseOrder) {\n  if (sortBy !== 'none' && id === sortBy && !reverseOrder) {\n    return /*#__PURE__*/React.createElement(SortDesc, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 16\n      }\n    });\n  }\n\n  if (sortBy !== 'none' && id === sortBy && reverseOrder) {\n    return /*#__PURE__*/React.createElement(SortAsc, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(SortDefault, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 12\n    }\n  });\n};\n\nvar MarketsListComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(MarketsListComponent, _React$Component);\n\n  var _super = _createSuper(MarketsListComponent);\n\n  function MarketsListComponent(props) {\n    var _this2;\n\n    _classCallCheck(this, MarketsListComponent);\n\n    _this2 = _super.call(this, props);\n\n    _this2.currencyPairSelectHandler = function (key) {\n      var markets = _this2.props.markets;\n      var marketToSet = markets.find(function (el) {\n        return el.name === key;\n      });\n\n      _this2.props.setCurrentPrice(0);\n\n      if (marketToSet) {\n        _this2.props.setCurrentMarket(marketToSet);\n\n        if (!incrementalOrderBook()) {\n          _this2.props.depthFetch(marketToSet);\n        }\n      }\n    };\n\n    _this2.getHeaders = function () {\n      return [{\n        id: 'id',\n        translationKey: 'market'\n      }, {\n        id: 'last',\n        translationKey: 'last_price'\n      }, {\n        id: 'volume',\n        translationKey: 'volume'\n      }, {\n        id: 'price_change_percent_num',\n        translationKey: 'change'\n      }].map(function (obj) {\n        var _this2$state = _this2.state,\n            sortBy = _this2$state.sortBy,\n            reverseOrder = _this2$state.reverseOrder;\n        return _objectSpread(_objectSpread({}, obj), {}, {\n          selected: sortBy === obj.id,\n          reversed: sortBy === obj.id && reverseOrder\n        });\n      }).map(function (obj) {\n        var _this2$state2 = _this2.state,\n            sortBy = _this2$state2.sortBy,\n            reverseOrder = _this2$state2.reverseOrder;\n        var classname = classnames({\n          'pg-dropdown-markets-list-container__header-selected': obj.selected\n        });\n        return /*#__PURE__*/React.createElement(\"span\", {\n          className: classname,\n          key: obj.id,\n          onClick: function onClick() {\n            return _this2.handleHeaderClick(obj.id);\n          },\n          __self: _assertThisInitialized(_this2),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }\n        }, _this2.props.intl.formatMessage({\n          id: \"page.body.trade.header.markets.content.\".concat(obj.translationKey)\n        }), /*#__PURE__*/React.createElement(\"span\", {\n          className: \"sort-icon\",\n          __self: _assertThisInitialized(_this2),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 17\n          }\n        }, handleChangeSortIcon(sortBy, obj.id, reverseOrder)));\n      });\n    };\n\n    _this2.handleHeaderClick = function (key) {\n      var _this2$state3 = _this2.state,\n          sortBy = _this2$state3.sortBy,\n          reverseOrder = _this2$state3.reverseOrder;\n\n      if (key !== sortBy) {\n        _this2.setState({\n          sortBy: key,\n          reverseOrder: false\n        });\n      } else if (key === sortBy && !reverseOrder) {\n        _this2.setState({\n          reverseOrder: true\n        });\n      } else {\n        _this2.setState({\n          sortBy: 'none',\n          reverseOrder: false\n        });\n      }\n    };\n\n    _this2.state = {\n      sortBy: 'none',\n      reverseOrder: false\n    };\n    return _this2;\n  }\n\n  _createClass(MarketsListComponent, [{\n    key: \"render\",\n    value: function render() {\n      var data = this.mapMarkets();\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pg-dropdown-markets-list-container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Table, {\n        data: data.length > 0 ? data : [[]],\n        header: this.getHeaders(),\n        onSelect: this.currencyPairSelectHandler,\n        selectedKey: this.props.currentMarket && this.props.currentMarket.name,\n        rowKeyIndex: 0,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 17\n        }\n      }));\n    }\n  }, {\n    key: \"mapMarkets\",\n    value: function mapMarkets() {\n      var _this3 = this;\n\n      var _this$props = this.props,\n          markets = _this$props.markets,\n          marketTickers = _this$props.marketTickers,\n          search = _this$props.search,\n          currencyQuote = _this$props.currencyQuote;\n      var defaultTicker = {\n        last: 0,\n        volume: 0,\n        price_change_percent: '+0.00%'\n      };\n      var arr = [];\n      var marketsMapped = markets.map(function (market) {\n        return _objectSpread(_objectSpread({}, market), {}, {\n          last: (marketTickers[market.id] || defaultTicker).last,\n          volume: (marketTickers[market.id] || defaultTicker).volume,\n          price_change_percent: (marketTickers[market.id] || defaultTicker).price_change_percent,\n          price_change_percent_num: Number.parseFloat((marketTickers[market.id] || defaultTicker).price_change_percent)\n        });\n      });\n      var _this$state = this.state,\n          sortBy = _this$state.sortBy,\n          reverseOrder = _this$state.reverseOrder;\n\n      if (sortBy !== 'none') {\n        marketsMapped.sort(function (a, b) {\n          return a[sortBy] > b[sortBy] ? 1 : b[sortBy] > a[sortBy] ? -1 : 0;\n        });\n      }\n\n      reverseOrder && marketsMapped.reverse();\n      return marketsMapped.reduce(function (pV, cV) {\n        var _cV$name$toLowerCase$ = cV.name.toLowerCase().split('/'),\n            _cV$name$toLowerCase$2 = _slicedToArray(_cV$name$toLowerCase$, 2),\n            quote = _cV$name$toLowerCase$2[1];\n\n        if (cV.id.toLowerCase().includes(search.toLowerCase()) && (currencyQuote === '' || currencyQuote.toLowerCase() === quote || currencyQuote.toLowerCase() === 'all')) {\n          pV.push(cV);\n        }\n\n        return pV;\n      }, arr).map(function (market) {\n        var isPositive = /\\+/.test((marketTickers[market.id] || defaultTicker).price_change_percent);\n        var classname = classnames({\n          'pg-dropdown-markets-list-container__positive': isPositive,\n          'pg-dropdown-markets-list-container__negative': !isPositive\n        });\n        return [market.name, /*#__PURE__*/React.createElement(\"span\", {\n          className: classname,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 18\n          }\n        }, Decimal.format(Number(market.last), market.price_precision, ',')), /*#__PURE__*/React.createElement(\"span\", {\n          className: classname,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 18\n          }\n        }, Decimal.format(Number(market.volume), market.price_precision, ',')), /*#__PURE__*/React.createElement(\"span\", {\n          className: classname,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 18\n          }\n        }, market.price_change_percent)];\n      });\n    }\n  }]);\n\n  return MarketsListComponent;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    currentMarket: selectCurrentMarket(state),\n    markets: selectMarkets(state),\n    marketTickers: selectMarketTickers(state)\n  };\n};\n\nvar mapDispatchToProps = {\n  setCurrentMarket,\n  depthFetch,\n  setCurrentPrice\n};\nexport var MarketsList = compose(injectIntl, connect(mapStateToProps, mapDispatchToProps))(MarketsListComponent); // tslint:disable-line","map":{"version":3,"sources":["/Users/anthonypafundi/Desktop/baseapp/src/containers/ToolBar/MarketSelector/MarketsList/index.tsx"],"names":["classnames","React","injectIntl","connect","compose","incrementalOrderBook","SortAsc","SortDefault","SortDesc","Decimal","Table","depthFetch","selectCurrentMarket","selectMarkets","selectMarketTickers","setCurrentMarket","setCurrentPrice","handleChangeSortIcon","sortBy","id","reverseOrder","MarketsListComponent","props","currencyPairSelectHandler","key","markets","marketToSet","find","el","name","getHeaders","translationKey","map","obj","state","selected","reversed","classname","handleHeaderClick","intl","formatMessage","setState","data","mapMarkets","length","currentMarket","marketTickers","search","currencyQuote","defaultTicker","last","volume","price_change_percent","arr","marketsMapped","market","price_change_percent_num","Number","parseFloat","sort","a","b","reverse","reduce","pV","cV","toLowerCase","split","quote","includes","push","isPositive","test","format","price_precision","Component","mapStateToProps","mapDispatchToProps","MarketsList"],"mappings":"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","sourcesContent":["import classnames from 'classnames';\nimport * as React from 'react';\nimport { injectIntl } from 'react-intl';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { IntlProps } from '../../../../';\nimport { incrementalOrderBook } from '../../../../api';\nimport { SortAsc, SortDefault, SortDesc } from '../../../../assets/images/SortIcons';\nimport { Decimal, Table } from '../../../../components';\nimport {\n    depthFetch,\n    Market,\n    RootState,\n    selectCurrentMarket,\n    selectMarkets,\n    selectMarketTickers,\n    setCurrentMarket,\n    setCurrentPrice,\n    Ticker,\n} from '../../../../modules';\n\ninterface ReduxProps {\n    currentMarket: Market | undefined;\n    markets: Market[];\n    marketTickers: {\n        [key: string]: Ticker,\n    };\n}\n\ninterface DispatchProps {\n    setCurrentMarket: typeof setCurrentMarket;\n    depthFetch: typeof depthFetch;\n    setCurrentPrice: typeof setCurrentPrice;\n}\n\ninterface OwnProps {\n    search: string;\n    currencyQuote: string;\n}\n\ninterface State {\n    sortBy: string;\n    reverseOrder: boolean;\n}\n\nconst handleChangeSortIcon = (sortBy: string, id: string, reverseOrder: boolean) => {\n    if (sortBy !== 'none' && id === sortBy && !reverseOrder) {\n        return <SortDesc/>;\n    }\n\n    if (sortBy !== 'none' && id === sortBy && reverseOrder) {\n        return <SortAsc/>;\n    }\n\n    return <SortDefault/>;\n};\n\ntype Props = ReduxProps & OwnProps & DispatchProps & IntlProps;\n\nclass MarketsListComponent extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            sortBy: 'none',\n            reverseOrder: false,\n        };\n    }\n\n    public render() {\n        const data = this.mapMarkets();\n\n        return (\n            <div className=\"pg-dropdown-markets-list-container\">\n                <Table\n                    data={data.length > 0 ? data : [[]]}\n                    header={this.getHeaders()}\n                    onSelect={this.currencyPairSelectHandler}\n                    selectedKey={this.props.currentMarket && this.props.currentMarket.name}\n                    rowKeyIndex={0}\n                />\n            </div>\n        );\n    }\n\n    private currencyPairSelectHandler = (key: string) => {\n        const { markets } = this.props;\n        const marketToSet = markets.find(el => el.name === key);\n\n        this.props.setCurrentPrice(0);\n        if (marketToSet) {\n            this.props.setCurrentMarket(marketToSet);\n            if (!incrementalOrderBook()) {\n              this.props.depthFetch(marketToSet);\n            }\n        }\n    };\n\n    private getHeaders = () => [\n        {id: 'id', translationKey: 'market'},\n        {id: 'last', translationKey: 'last_price'},\n        {id: 'volume', translationKey: 'volume'},\n        {id: 'price_change_percent_num', translationKey: 'change'},\n    ].map(obj => {\n        const {sortBy, reverseOrder} = this.state;\n\n        return (\n            {\n                ...obj,\n                selected: sortBy === obj.id,\n                reversed: sortBy === obj.id && reverseOrder,\n            }\n        );\n    }).map(obj => {\n        const {sortBy, reverseOrder} = this.state;\n        const classname = classnames({\n            'pg-dropdown-markets-list-container__header-selected': obj.selected,\n        });\n\n        return (\n            <span className={classname} key={obj.id} onClick={() => this.handleHeaderClick(obj.id)}>\n            {this.props.intl.formatMessage({id: `page.body.trade.header.markets.content.${obj.translationKey}`})}\n                <span className=\"sort-icon\">\n                    {handleChangeSortIcon(sortBy, obj.id, reverseOrder)}\n                </span>\n            </span>\n        );\n    });\n\n    private mapMarkets() {\n        const { markets, marketTickers, search, currencyQuote } = this.props;\n        const defaultTicker = {\n            last: 0,\n            volume: 0,\n            price_change_percent: '+0.00%',\n        };\n        const arr: Market[] = [];\n\n        const marketsMapped = markets.map((market: Market) => {\n            return {\n                ...market,\n                last: (marketTickers[market.id] || defaultTicker).last,\n                volume: (marketTickers[market.id] || defaultTicker).volume,\n                price_change_percent: (marketTickers[market.id] || defaultTicker).price_change_percent,\n                price_change_percent_num: Number.parseFloat((marketTickers[market.id] || defaultTicker).price_change_percent),\n            };\n        });\n\n        const {sortBy, reverseOrder} = this.state;\n\n        if (sortBy !== 'none') {\n            marketsMapped.sort((a, b) => a[sortBy] > b[sortBy] ? 1 : b[sortBy] > a[sortBy] ? -1 : 0);\n        }\n\n        reverseOrder && marketsMapped.reverse();\n\n        return marketsMapped.reduce((pV, cV) => {\n            const [,quote] = cV.name.toLowerCase().split('/');\n            if (\n                cV.id.toLowerCase().includes(search.toLowerCase()) &&\n                (\n                    currencyQuote === '' ||\n                    currencyQuote.toLowerCase() === quote ||\n                    currencyQuote.toLowerCase() === 'all'\n                )\n            ) {\n                pV.push(cV);\n            }\n\n            return pV;\n        }, arr).map((market: any) => {\n            const isPositive = /\\+/.test((marketTickers[market.id] || defaultTicker).price_change_percent);\n            const classname = classnames({\n                'pg-dropdown-markets-list-container__positive': isPositive,\n                'pg-dropdown-markets-list-container__negative': !isPositive,\n            });\n\n            return [\n                market.name,\n                (<span className={classname}>{Decimal.format(Number(market.last), market.price_precision, ',')}</span>),\n                (<span className={classname}>{Decimal.format(Number(market.volume), market.price_precision, ',')}</span>),\n                (<span className={classname}>{market.price_change_percent}</span>),\n            ];\n        });\n    }\n\n    private handleHeaderClick = (key: string) => {\n        const {sortBy, reverseOrder} = this.state;\n        if (key !== sortBy) {\n            this.setState({sortBy: key, reverseOrder: false});\n        } else if (key === sortBy && !reverseOrder) {\n            this.setState({reverseOrder: true});\n        } else {\n            this.setState({sortBy: 'none', reverseOrder: false});\n        }\n    };\n}\n\nconst mapStateToProps = (state: RootState): ReduxProps => ({\n    currentMarket: selectCurrentMarket(state),\n    markets: selectMarkets(state),\n    marketTickers: selectMarketTickers(state),\n});\n\nconst mapDispatchToProps = {\n    setCurrentMarket,\n    depthFetch,\n    setCurrentPrice,\n};\n\nexport const MarketsList = compose(\n    injectIntl,\n    connect(mapStateToProps, mapDispatchToProps),\n)(MarketsListComponent) as any; // tslint:disable-line\n"]},"metadata":{},"sourceType":"module"}